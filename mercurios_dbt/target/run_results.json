{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-03-11T09:28:12.610931Z", "invocation_id": "b1e47044-e608-4bc9-85bd-9d85edb5d40b", "env": {}}, "results": [{"status": "error", "timing": [{"name": "compile", "started_at": "2025-03-11T09:28:05.226591Z", "completed_at": "2025-03-11T09:28:05.235317Z"}, {"name": "execute", "started_at": "2025-03-11T09:28:05.251808Z", "completed_at": "2025-03-11T09:28:09.122656Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 3.988551139831543, "adapter_response": {}, "message": "Database Error in model stg_ga4_product_performance (models/staging/stg_ga4_product_performance.sql)\n  003001 (42501): SQL access control error:\n  Insufficient privileges to operate on table 'ECOMMERCE_PURCHASES_ITEM_ID_REPORT'\n  compiled code at target/run/mercurios/models/staging/stg_ga4_product_performance.sql", "failures": null, "unique_id": "model.mercurios.stg_ga4_product_performance", "compiled": true, "compiled_code": "with ecommerce_item_id as (\n    select \n        date_date,\n        property_id,\n        item_id,\n        item_name,\n        item_brand,\n        item_category,\n        item_category2,\n        item_category3,\n        item_category4,\n        item_category5,\n        price,\n        quantity,\n        item_revenue,\n        purchase_revenue,\n        purchase_revenue_in_usd,\n        refund_value,\n        refund_value_in_usd,\n        shipping_value,\n        shipping_value_in_usd,\n        tax_value,\n        tax_value_in_usd,\n        unique_items,\n        transactions\n    from MERCURIOS_DATA.GOOGLE_ANALYTICS_4.ECOMMERCE_PURCHASES_ITEM_ID_REPORT\n),\n\necommerce_item_name as (\n    select \n        date_date,\n        property_id,\n        item_name,\n        sum(quantity) as total_quantity,\n        sum(item_revenue) as total_revenue,\n        sum(transactions) as total_transactions,\n        count(distinct date_date) as days_with_sales\n    from MERCURIOS_DATA.GOOGLE_ANALYTICS_4.ECOMMERCE_PURCHASES_ITEM_NAME_REPORT\n    group by 1, 2, 3\n),\n\npage_views as (\n    select \n        date_date,\n        property_id,\n        page_path,\n        page_title,\n        screen_class,\n        screen_name,\n        entrances,\n        engaged_sessions,\n        engagement_rate,\n        engagement_time_msec,\n        page_views,\n        screen_views,\n        active_users\n    from MERCURIOS_DATA.GOOGLE_ANALYTICS_4.PAGES_PATH_REPORT\n),\n\ncombined as (\n    select \n        e.date_date,\n        e.property_id,\n        e.item_id,\n        e.item_name,\n        e.item_brand,\n        e.item_category,\n        e.price,\n        e.quantity,\n        e.item_revenue,\n        e.transactions,\n        n.total_quantity,\n        n.total_revenue,\n        n.total_transactions,\n        n.days_with_sales,\n        \n        -- Join with page views (assuming product pages follow a pattern like /product/[item_id])\n        -- This is an example and might need adjustment based on your actual URL structure\n        p.page_views,\n        p.active_users,\n        p.engagement_rate,\n        \n        -- Calculate metrics\n        case \n            when n.days_with_sales > 0 then n.total_quantity / n.days_with_sales \n            else 0 \n        end as daily_sales_rate,\n        \n        case \n            when p.page_views > 0 then (n.total_transactions * 100.0) / p.page_views \n            else 0 \n        end as conversion_rate,\n        \n        -- Add product performance categorization\n        case\n            when n.total_revenue > 1000 then 'High Value'\n            when n.total_revenue > 500 then 'Medium Value'\n            when n.total_revenue > 100 then 'Low Value'\n            else 'Very Low Value'\n        end as revenue_category,\n        \n        case\n            when n.total_quantity > 50 then 'High Volume'\n            when n.total_quantity > 20 then 'Medium Volume'\n            when n.total_quantity > 5 then 'Low Volume'\n            else 'Very Low Volume'\n        end as volume_category,\n        \n        -- Add metadata fields\n        current_timestamp() as dbt_updated_at,\n        'b1e47044-e608-4bc9-85bd-9d85edb5d40b' as dbt_updated_by,\n        'stg_ga4_product_performance' as dbt_model\n    from ecommerce_item_id e\n    left join ecommerce_item_name n\n        on e.date_date = n.date_date\n        and e.property_id = n.property_id\n        and e.item_name = n.item_name\n    left join page_views p\n        on e.date_date = p.date_date\n        and e.property_id = p.property_id\n        and p.page_path like '%/product/' || e.item_id || '%'\n)\n\nselect * from combined", "relation_name": "MERCURIOS_DATA.RAW_staging.stg_ga4_product_performance", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-14 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.mercurios.int_product_performance_combined", "compiled": false, "compiled_code": null, "relation_name": "MERCURIOS_DATA.RAW_intermediate.int_product_performance_combined", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-11 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.mercurios.fct_product_insights", "compiled": false, "compiled_code": null, "relation_name": "MERCURIOS_DATA.RAW_marts.fct_product_insights", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-03-11T09:28:05.231795Z", "completed_at": "2025-03-11T09:28:05.234862Z"}, {"name": "execute", "started_at": "2025-03-11T09:28:05.235577Z", "completed_at": "2025-03-11T09:28:12.502385Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 7.376698970794678, "adapter_response": {}, "message": "Database Error in model stg_ga4_user_acquisition (models/staging/stg_ga4_user_acquisition.sql)\n  003001 (42501): SQL access control error:\n  Insufficient privileges to operate on table 'USER_ACQUISITION_FIRST_USER_SOURCE_MEDIUM_REPORT'\n  compiled code at target/run/mercurios/models/staging/stg_ga4_user_acquisition.sql", "failures": null, "unique_id": "model.mercurios.stg_ga4_user_acquisition", "compiled": true, "compiled_code": "with user_source_medium as (\n    select \n        date_date,\n        property_id,\n        first_user_source,\n        first_user_medium,\n        first_user_campaign,\n        first_user_google_ads_ad_network_type,\n        first_user_google_ads_ad_group_name,\n        active_users,\n        new_users,\n        engaged_sessions,\n        engagement_rate,\n        engagement_time_msec,\n        total_revenue,\n        total_revenue_per_user,\n        transactions,\n        transactions_per_user,\n        conversions,\n        conversions_per_user,\n        ecommerce_purchases,\n        ecommerce_purchases_per_user\n    from MERCURIOS_DATA.GOOGLE_ANALYTICS_4.USER_ACQUISITION_FIRST_USER_SOURCE_MEDIUM_REPORT\n),\n\nuser_campaign as (\n    select \n        date_date,\n        property_id,\n        first_user_campaign,\n        sum(active_users) as total_active_users,\n        sum(new_users) as total_new_users,\n        sum(engaged_sessions) as total_engaged_sessions,\n        sum(total_revenue) as total_campaign_revenue,\n        sum(transactions) as total_campaign_transactions,\n        sum(conversions) as total_campaign_conversions,\n        sum(ecommerce_purchases) as total_campaign_purchases\n    from MERCURIOS_DATA.GOOGLE_ANALYTICS_4.USER_ACQUISITION_FIRST_USER_CAMPAIGN_REPORT\n    group by 1, 2, 3\n),\n\ndemographic_data as (\n    select \n        date_date,\n        property_id,\n        country,\n        region,\n        city,\n        sum(active_users) as total_users_by_location,\n        sum(new_users) as new_users_by_location,\n        sum(total_revenue) as total_revenue_by_location,\n        sum(transactions) as transactions_by_location\n    from MERCURIOS_DATA.GOOGLE_ANALYTICS_4.DEMOGRAPHIC_CITY_REPORT\n    group by 1, 2, 3, 4, 5\n),\n\ncombined as (\n    select \n        u.date_date,\n        u.property_id,\n        u.first_user_source,\n        u.first_user_medium,\n        u.first_user_campaign,\n        u.active_users,\n        u.new_users,\n        u.engaged_sessions,\n        u.engagement_rate,\n        u.total_revenue,\n        u.transactions,\n        u.conversions,\n        u.ecommerce_purchases,\n        \n        -- Join with campaign data\n        c.total_active_users as campaign_active_users,\n        c.total_new_users as campaign_new_users,\n        c.total_campaign_revenue,\n        c.total_campaign_transactions,\n        \n        -- Calculate user value metrics\n        case \n            when u.active_users > 0 then u.total_revenue / u.active_users \n            else 0 \n        end as revenue_per_user,\n        \n        case \n            when u.active_users > 0 then u.transactions / u.active_users \n            else 0 \n        end as transactions_per_user,\n        \n        case \n            when u.active_users > 0 then u.conversions / u.active_users \n            else 0 \n        end as conversions_per_user,\n        \n        -- Add user acquisition categorization\n        case\n            when u.first_user_source = 'google' and u.first_user_medium = 'organic' then 'Organic Search'\n            when u.first_user_source = 'google' and u.first_user_medium = 'cpc' then 'Paid Search'\n            when u.first_user_medium = 'email' then 'Email Marketing'\n            when u.first_user_medium = 'social' then 'Social Media'\n            when u.first_user_medium = 'referral' then 'Referral'\n            when u.first_user_medium = 'direct' then 'Direct'\n            else 'Other'\n        end as acquisition_channel,\n        \n        -- Add user value categorization\n        case\n            when u.total_revenue > 500 then 'High Value'\n            when u.total_revenue > 100 then 'Medium Value'\n            when u.total_revenue > 0 then 'Low Value'\n            else 'No Purchase'\n        end as user_value_segment,\n        \n        -- Add metadata fields\n        current_timestamp() as dbt_updated_at,\n        'b1e47044-e608-4bc9-85bd-9d85edb5d40b' as dbt_updated_by,\n        'stg_ga4_user_acquisition' as dbt_model\n    from user_source_medium u\n    left join user_campaign c\n        on u.date_date = c.date_date\n        and u.property_id = c.property_id\n        and u.first_user_campaign = c.first_user_campaign\n)\n\nselect * from combined", "relation_name": "MERCURIOS_DATA.RAW_staging.stg_ga4_user_acquisition", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-14 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.mercurios.int_customer_behavior_combined", "compiled": false, "compiled_code": null, "relation_name": "MERCURIOS_DATA.RAW_intermediate.int_customer_behavior_combined", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-11 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.mercurios.fct_customer_insights", "compiled": false, "compiled_code": null, "relation_name": "MERCURIOS_DATA.RAW_marts.fct_customer_insights", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-13 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.mercurios.fct_inventory_forecast_enhanced", "compiled": false, "compiled_code": null, "relation_name": "MERCURIOS_DATA.RAW_marts.fct_inventory_forecast_enhanced", "batch_results": null}], "elapsed_time": 59.92506694793701, "args": {"partial_parse": true, "log_format": "default", "vars": {}, "write_json": true, "print": true, "send_anonymous_usage_stats": true, "log_level": "info", "version_check": true, "require_yaml_configuration_for_mf_time_spines": false, "indirect_selection": "eager", "state_modified_compare_more_unrendered_values": false, "log_format_file": "debug", "require_resource_names_without_spaces": false, "which": "run", "require_explicit_package_overrides_for_builtin_materializations": true, "log_path": "/Users/juliusrechenbach/API ProHandelTest/mercurios_dbt/logs", "require_batched_execution_for_custom_microbatch_strategy": false, "favor_state": false, "use_colors_file": true, "log_level_file": "debug", "printer_width": 80, "log_file_max_bytes": 10485760, "use_colors": true, "profiles_dir": "/Users/juliusrechenbach/API ProHandelTest/mercurios_dbt", "macro_debugging": false, "state_modified_compare_vars": false, "partial_parse_file_diff": true, "show_resource_report": false, "empty": false, "warn_error_options": {"include": [], "exclude": []}, "quiet": false, "introspect": true, "require_nested_cumulative_type_params": false, "exclude": [], "populate_cache": true, "invocation_command": "dbt run --select stg_ga4_product_performance stg_ga4_user_acquisition int_product_performance_combined int_customer_behavior_combined fct_product_insights fct_customer_insights fct_inventory_forecast_enhanced", "cache_selected_only": false, "project_dir": "/Users/juliusrechenbach/API ProHandelTest/mercurios_dbt", "defer": false, "skip_nodes_if_on_run_start_fails": false, "select": ["stg_ga4_product_performance", "stg_ga4_user_acquisition", "int_product_performance_combined", "int_customer_behavior_combined", "fct_product_insights", "fct_customer_insights", "fct_inventory_forecast_enhanced"], "source_freshness_run_project_hooks": false, "static_parser": true, "strict_mode": false}}