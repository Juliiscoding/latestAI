%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
2025-03-03 13:22:38 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:22:38 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:22:38 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:22:38 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:22:38 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:22:38 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:22:38 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:22:38 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:22:38 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:22:38 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:22:38 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:52:38.898412
2025-03-03 13:22:38 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:52:38.898412
2025-03-03 13:22:39 - mercurios_etl - ERROR - Request failed: 401 Client Error: Unauthorized for url: https://api.prohandel.de/api/v2/article
2025-03-03 13:22:39 - mercurios_etl - ERROR - Request failed: 401 Client Error: Unauthorized for url: https://api.prohandel.de/api/v2/article
2025-03-03 13:22:39 - backoff - INFO - Backing off _make_request(...) for 1.3s (requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://api.prohandel.de/api/v2/article)
2025-03-03 13:22:40 - mercurios_etl - ERROR - Request failed: 401 Client Error: Unauthorized for url: https://api.prohandel.de/api/v2/article
2025-03-03 13:22:40 - mercurios_etl - ERROR - Request failed: 401 Client Error: Unauthorized for url: https://api.prohandel.de/api/v2/article
2025-03-03 13:22:40 - backoff - INFO - Backing off _make_request(...) for 3.5s (requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://api.prohandel.de/api/v2/article)
2025-03-03 13:22:44 - mercurios_etl - ERROR - Request failed: 401 Client Error: Unauthorized for url: https://api.prohandel.de/api/v2/article
2025-03-03 13:22:44 - mercurios_etl - ERROR - Request failed: 401 Client Error: Unauthorized for url: https://api.prohandel.de/api/v2/article
2025-03-03 13:22:44 - backoff - ERROR - Giving up _make_request(...) after 3 tries (requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://api.prohandel.de/api/v2/article)
2025-03-03 13:22:44 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 5)
2025-03-03 13:22:44 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 5)
2025-03-03 13:22:44 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://api.prohandel.de/api/v2article?page=1&pagesize=5
2025-03-03 13:22:44 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://api.prohandel.de/api/v2article?page=1&pagesize=5
2025-03-03 13:22:44 - backoff - INFO - Backing off _make_request(...) for 0.2s (requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://api.prohandel.de/api/v2article?page=1&pagesize=5)
2025-03-03 13:22:44 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://api.prohandel.de/api/v2article?page=1&pagesize=5
2025-03-03 13:22:44 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://api.prohandel.de/api/v2article?page=1&pagesize=5
2025-03-03 13:22:44 - backoff - INFO - Backing off _make_request(...) for 0.0s (requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://api.prohandel.de/api/v2article?page=1&pagesize=5)
2025-03-03 13:22:44 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://api.prohandel.de/api/v2article?page=1&pagesize=5
2025-03-03 13:22:44 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://api.prohandel.de/api/v2article?page=1&pagesize=5
2025-03-03 13:22:44 - backoff - ERROR - Giving up _make_request(...) after 3 tries (requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://api.prohandel.de/api/v2article?page=1&pagesize=5)
2025-03-03 13:22:44 - mercurios_etl - ERROR - Error fetching article data: 404 Client Error: Not Found for url: https://api.prohandel.de/api/v2article?page=1&pagesize=5
2025-03-03 13:22:44 - mercurios_etl - ERROR - Error fetching article data: 404 Client Error: Not Found for url: https://api.prohandel.de/api/v2article?page=1&pagesize=5
2025-03-03 13:23:18 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:23:18 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:23:18 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:23:18 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:23:19 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:23:19 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:23:19 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:23:19 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:23:19 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:23:19 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:23:19 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:53:19.067462
2025-03-03 13:23:19 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:53:19.067462
2025-03-03 13:23:19 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://linde.prohandel.de/article
2025-03-03 13:23:19 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://linde.prohandel.de/article
2025-03-03 13:23:19 - backoff - INFO - Backing off _make_request(...) for 0.5s (requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://linde.prohandel.de/article)
2025-03-03 13:23:19 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://linde.prohandel.de/article
2025-03-03 13:23:19 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://linde.prohandel.de/article
2025-03-03 13:23:19 - backoff - INFO - Backing off _make_request(...) for 0.2s (requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://linde.prohandel.de/article)
2025-03-03 13:23:20 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://linde.prohandel.de/article
2025-03-03 13:23:20 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://linde.prohandel.de/article
2025-03-03 13:23:20 - backoff - ERROR - Giving up _make_request(...) after 3 tries (requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://linde.prohandel.de/article)
2025-03-03 13:23:20 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 5)
2025-03-03 13:23:20 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 5)
2025-03-03 13:23:20 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://linde.prohandel.de/article?page=1&pagesize=5
2025-03-03 13:23:20 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://linde.prohandel.de/article?page=1&pagesize=5
2025-03-03 13:23:20 - backoff - INFO - Backing off _make_request(...) for 0.6s (requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://linde.prohandel.de/article?page=1&pagesize=5)
2025-03-03 13:23:21 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://linde.prohandel.de/article?page=1&pagesize=5
2025-03-03 13:23:21 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://linde.prohandel.de/article?page=1&pagesize=5
2025-03-03 13:23:21 - backoff - INFO - Backing off _make_request(...) for 0.2s (requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://linde.prohandel.de/article?page=1&pagesize=5)
2025-03-03 13:23:21 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://linde.prohandel.de/article?page=1&pagesize=5
2025-03-03 13:23:21 - mercurios_etl - ERROR - Request failed: 404 Client Error: Not Found for url: https://linde.prohandel.de/article?page=1&pagesize=5
2025-03-03 13:23:21 - backoff - ERROR - Giving up _make_request(...) after 3 tries (requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://linde.prohandel.de/article?page=1&pagesize=5)
2025-03-03 13:23:21 - mercurios_etl - ERROR - Error fetching article data: 404 Client Error: Not Found for url: https://linde.prohandel.de/article?page=1&pagesize=5
2025-03-03 13:23:21 - mercurios_etl - ERROR - Error fetching article data: 404 Client Error: Not Found for url: https://linde.prohandel.de/article?page=1&pagesize=5
2025-03-03 13:23:44 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:23:44 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:23:44 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:23:44 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:23:45 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:23:45 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:23:45 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:23:45 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:23:45 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:23:45 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:23:45 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:53:45.125527
2025-03-03 13:23:45 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:53:45.125527
2025-03-03 13:23:45 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 5)
2025-03-03 13:23:45 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 5)
2025-03-03 13:23:50 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:23:50 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:23:50 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:23:50 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:23:50 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:23:50 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:23:50 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:23:50 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:23:50 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:23:50 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:23:50 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:53:50.904043
2025-03-03 13:23:50 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:53:50.904043
2025-03-03 13:23:51 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 5)
2025-03-03 13:23:51 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 5)
2025-03-03 13:23:56 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:23:56 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:23:56 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:23:56 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:23:56 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:23:56 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:23:56 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:23:56 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:23:56 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:23:56 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:23:56 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:53:56.280600
2025-03-03 13:23:56 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:53:56.280600
2025-03-03 13:23:56 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 5)
2025-03-03 13:23:56 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 5)
2025-03-03 13:24:01 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:24:01 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:24:01 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:24:01 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:24:02 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:24:02 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:24:02 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:24:02 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:24:02 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:24:02 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:24:02 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:54:02.060994
2025-03-03 13:24:02 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:54:02.060994
2025-03-03 13:24:02 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 5)
2025-03-03 13:24:02 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 5)
2025-03-03 13:24:02 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 5)
2025-03-03 13:24:02 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 5)
2025-03-03 13:24:03 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 5)
2025-03-03 13:24:03 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 5)
2025-03-03 13:24:04 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 5)
2025-03-03 13:24:04 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 5)
2025-03-03 13:24:06 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 5)
2025-03-03 13:24:06 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 5)
2025-03-03 13:24:06 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 5)
2025-03-03 13:24:06 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 5)
2025-03-03 13:24:06 - mercurios_etl - INFO - Fetching supplier data (page 1, pagesize 5)
2025-03-03 13:24:06 - mercurios_etl - INFO - Fetching supplier data (page 1, pagesize 5)
2025-03-03 13:24:07 - mercurios_etl - INFO - Fetching category data (page 1, pagesize 5)
2025-03-03 13:24:07 - mercurios_etl - INFO - Fetching category data (page 1, pagesize 5)
2025-03-03 13:24:07 - mercurios_etl - INFO - Fetching staff data (page 1, pagesize 5)
2025-03-03 13:24:07 - mercurios_etl - INFO - Fetching staff data (page 1, pagesize 5)
2025-03-03 13:24:07 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 5)
2025-03-03 13:24:07 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 5)
2025-03-03 13:24:07 - mercurios_etl - INFO - Fetching articlesize data (page 1, pagesize 5)
2025-03-03 13:24:07 - mercurios_etl - INFO - Fetching articlesize data (page 1, pagesize 5)
2025-03-03 13:24:07 - mercurios_etl - INFO - Fetching country data (page 1, pagesize 5)
2025-03-03 13:24:07 - mercurios_etl - INFO - Fetching country data (page 1, pagesize 5)
2025-03-03 13:24:08 - mercurios_etl - INFO - Fetching currency data (page 1, pagesize 5)
2025-03-03 13:24:08 - mercurios_etl - INFO - Fetching currency data (page 1, pagesize 5)
2025-03-03 13:24:08 - mercurios_etl - INFO - Fetching invoice data (page 1, pagesize 5)
2025-03-03 13:24:08 - mercurios_etl - INFO - Fetching invoice data (page 1, pagesize 5)
2025-03-03 13:24:08 - mercurios_etl - INFO - Fetching payment data (page 1, pagesize 5)
2025-03-03 13:24:08 - mercurios_etl - INFO - Fetching payment data (page 1, pagesize 5)
2025-03-03 13:24:08 - mercurios_etl - INFO - Fetching season data (page 1, pagesize 5)
2025-03-03 13:24:08 - mercurios_etl - INFO - Fetching season data (page 1, pagesize 5)
2025-03-03 13:24:09 - mercurios_etl - INFO - Fetching size data (page 1, pagesize 5)
2025-03-03 13:24:09 - mercurios_etl - INFO - Fetching size data (page 1, pagesize 5)
2025-03-03 13:24:09 - mercurios_etl - INFO - Fetching voucher data (page 1, pagesize 5)
2025-03-03 13:24:09 - mercurios_etl - INFO - Fetching voucher data (page 1, pagesize 5)
2025-03-03 13:24:30 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:24:30 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:24:30 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:24:30 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:24:31 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:24:31 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:24:31 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:24:31 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:24:31 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:24:31 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:24:31 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:54:31.185701
2025-03-03 13:24:31 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:54:31.185701
2025-03-03 13:24:31 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 5)
2025-03-03 13:24:31 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 5)
2025-03-03 13:26:14 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:26:14 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:26:14 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:26:14 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:26:15 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:26:15 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:26:15 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:26:15 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:26:15 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:26:15 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:26:15 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:56:15.092324
2025-03-03 13:26:15 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 13:56:15.092324
2025-03-03 13:53:16 - mercurios_etl - INFO - Starting end-to-end tests for ProHandel Lambda function
2025-03-03 13:53:16 - mercurios_etl - INFO - Starting end-to-end tests for ProHandel Lambda function
2025-03-03 13:53:16 - mercurios_etl - INFO - ===== TESTING LAMBDA HANDLERS =====
2025-03-03 13:53:16 - mercurios_etl - INFO - ===== TESTING LAMBDA HANDLERS =====
2025-03-03 13:53:16 - mercurios_etl - INFO - Testing 'test' operation...
2025-03-03 13:53:16 - mercurios_etl - INFO - Testing 'test' operation...
2025-03-03 13:53:16 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 13:53:16 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 13:53:16 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:53:16 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:53:16 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:53:16 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:53:16 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:53:16 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:53:16 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:53:16 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:53:16 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:53:16 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:53:16 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 14:23:16.553343
2025-03-03 13:53:16 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 14:23:16.553343
2025-03-03 13:53:16 - mercurios_etl - INFO - ✅ Test operation successful
2025-03-03 13:53:16 - mercurios_etl - INFO - ✅ Test operation successful
2025-03-03 13:53:16 - mercurios_etl - INFO - Test response: {
  "status": "ok",
  "message": "Successfully connected to ProHandel API"
}
2025-03-03 13:53:16 - mercurios_etl - INFO - Test response: {
  "status": "ok",
  "message": "Successfully connected to ProHandel API"
}
2025-03-03 13:53:16 - mercurios_etl - INFO - Testing 'schema' operation...
2025-03-03 13:53:16 - mercurios_etl - INFO - Testing 'schema' operation...
2025-03-03 13:53:16 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 13:53:16 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 13:53:16 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 1)
2025-03-03 13:53:16 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 1)
2025-03-03 13:53:16 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 1)
2025-03-03 13:53:16 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 1)
2025-03-03 13:53:17 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 1)
2025-03-03 13:53:17 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 1)
2025-03-03 13:53:18 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 1)
2025-03-03 13:53:18 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 1)
2025-03-03 13:53:18 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 1)
2025-03-03 13:53:18 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 1)
2025-03-03 13:53:18 - mercurios_etl - INFO - Fetching supplier data (page 1, pagesize 1)
2025-03-03 13:53:18 - mercurios_etl - INFO - Fetching supplier data (page 1, pagesize 1)
2025-03-03 13:53:18 - mercurios_etl - INFO - Fetching category data (page 1, pagesize 1)
2025-03-03 13:53:18 - mercurios_etl - INFO - Fetching category data (page 1, pagesize 1)
2025-03-03 13:53:18 - mercurios_etl - INFO - Fetching staff data (page 1, pagesize 1)
2025-03-03 13:53:18 - mercurios_etl - INFO - Fetching staff data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching articlesize data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching articlesize data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching country data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching country data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching currency data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching currency data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching invoice data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching invoice data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching payment data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching payment data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching season data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching season data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching size data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching size data (page 1, pagesize 1)
2025-03-03 13:53:19 - mercurios_etl - INFO - ✅ Schema operation successful, found 19 tables including 'shop'
2025-03-03 13:53:19 - mercurios_etl - INFO - ✅ Schema operation successful, found 19 tables including 'shop'
2025-03-03 13:53:19 - mercurios_etl - INFO - Testing 'sync' operation...
2025-03-03 13:53:19 - mercurios_etl - INFO - Testing 'sync' operation...
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:53:19 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:53:20 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:53:20 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:53:20 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:53:20 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:53:21 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:53:21 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:53:23 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:53:23 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:53:24 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:53:24 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:53:24 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:53:24 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:53:24 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:53:24 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:53:24 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 13:53:24 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 13:53:24 - mercurios_etl - INFO - Sync response contains data for tables: article, customer, order, sale, inventory, shop, daily_sales_agg
2025-03-03 13:53:24 - mercurios_etl - INFO - Sync response contains data for tables: article, customer, order, sale, inventory, shop, daily_sales_agg
2025-03-03 13:53:24 - mercurios_etl - INFO - ✅ Found 5 shop records
2025-03-03 13:53:24 - mercurios_etl - INFO - ✅ Found 5 shop records
2025-03-03 13:53:24 - mercurios_etl - INFO - ✅ Found aggregation table 'daily_sales_agg' with 4 records
2025-03-03 13:53:24 - mercurios_etl - INFO - ✅ Found aggregation table 'daily_sales_agg' with 4 records
2025-03-03 13:53:24 - mercurios_etl - INFO - ✅ Sync operation successful
2025-03-03 13:53:24 - mercurios_etl - INFO - ✅ Sync operation successful
2025-03-03 13:53:24 - mercurios_etl - INFO - ===== VERIFYING SHOP MAPPING =====
2025-03-03 13:53:24 - mercurios_etl - INFO - ===== VERIFYING SHOP MAPPING =====
2025-03-03 13:53:24 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:53:24 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:53:24 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:53:24 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:53:25 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:53:25 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:53:25 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:53:25 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:53:27 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:53:27 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:53:27 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:53:27 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:53:27 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:53:27 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:53:27 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:53:27 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:53:27 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 13:53:27 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 13:53:27 - mercurios_etl - INFO - ✅ Shop mapping verified successfully with 5 records
2025-03-03 13:53:27 - mercurios_etl - INFO - ✅ Shop mapping verified successfully with 5 records
2025-03-03 13:53:27 - mercurios_etl - INFO - Sample shop record: {
  "stateNumber": 0,
  "isActive": true,
  "imageName": "",
  "bankCode": 0,
  "email": "neu00511323278",
  "fax": "",
  "id": "0f319673-6c29-4ed2-b28b-8886dd2a9a31",
  "iban": "",
  "glN1": 4399901477599.0,
  "glN2": 4399901477599.0,
  "branchInfo": "",
  "isWebshop": false,
  "stocktakingDate": "2016-03-31T00:00:00",
  "bankAccount": "509450000",
  "logoFileName": "",
  "searchTerm": "Filiale1",
  "name1": "I. G.von der Linde GmbH & CoKG",
  "name2": "",
  "name3": "",
  "number": 1,
  "city": "Hannover",
  "zipCode": "30167",
  "street": "An der Christuskirche 17",
  "bic": "",
  "telephoneNumber": "0511/36 606 0",
  "countryNumber": "D",
  "regionNumber": 0,
  "lastChange": "2022-03-29T15:33:33.3709455",
  "isDeleted": false,
  "openMonday": null,
  "openTuesday": null,
  "openWednesday": null,
  "openThursday": null,
  "openFriday": null,
  "openSaturday": null,
  "openSunday": null,
  "shop_type": "Retail",
  "is_online": false
}
2025-03-03 13:53:27 - mercurios_etl - INFO - Sample shop record: {
  "stateNumber": 0,
  "isActive": true,
  "imageName": "",
  "bankCode": 0,
  "email": "neu00511323278",
  "fax": "",
  "id": "0f319673-6c29-4ed2-b28b-8886dd2a9a31",
  "iban": "",
  "glN1": 4399901477599.0,
  "glN2": 4399901477599.0,
  "branchInfo": "",
  "isWebshop": false,
  "stocktakingDate": "2016-03-31T00:00:00",
  "bankAccount": "509450000",
  "logoFileName": "",
  "searchTerm": "Filiale1",
  "name1": "I. G.von der Linde GmbH & CoKG",
  "name2": "",
  "name3": "",
  "number": 1,
  "city": "Hannover",
  "zipCode": "30167",
  "street": "An der Christuskirche 17",
  "bic": "",
  "telephoneNumber": "0511/36 606 0",
  "countryNumber": "D",
  "regionNumber": 0,
  "lastChange": "2022-03-29T15:33:33.3709455",
  "isDeleted": false,
  "openMonday": null,
  "openTuesday": null,
  "openWednesday": null,
  "openThursday": null,
  "openFriday": null,
  "openSaturday": null,
  "openSunday": null,
  "shop_type": "Retail",
  "is_online": false
}
2025-03-03 13:53:27 - mercurios_etl - INFO - ===== VERIFYING AGGREGATIONS =====
2025-03-03 13:53:27 - mercurios_etl - INFO - ===== VERIFYING AGGREGATIONS =====
2025-03-03 13:53:27 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:53:27 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:53:28 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:53:28 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:53:28 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:53:28 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:53:29 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:53:29 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:53:31 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:53:31 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:53:31 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:53:31 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:53:31 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:53:31 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:53:31 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:53:31 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:53:31 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 13:53:31 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 13:53:31 - mercurios_etl - INFO - ✅ Found 4 daily sales aggregation records
2025-03-03 13:53:31 - mercurios_etl - INFO - ✅ Found 4 daily sales aggregation records
2025-03-03 13:53:31 - mercurios_etl - INFO - ✅ Daily sales aggregation structure verified
2025-03-03 13:53:31 - mercurios_etl - INFO - ✅ Daily sales aggregation structure verified
2025-03-03 13:53:31 - mercurios_etl - INFO - Sample daily sales aggregation: {
  "date": "2015-11-13",
  "total_quantity": 0.0,
  "sale_count": 6,
  "aggregation_type": "daily"
}
2025-03-03 13:53:31 - mercurios_etl - INFO - Sample daily sales aggregation: {
  "date": "2015-11-13",
  "total_quantity": 0.0,
  "sale_count": 6,
  "aggregation_type": "daily"
}
2025-03-03 13:53:31 - mercurios_etl - WARNING - ⚠️ Article sales aggregation missing from sync response
2025-03-03 13:53:31 - mercurios_etl - WARNING - ⚠️ Article sales aggregation missing from sync response
2025-03-03 13:53:31 - mercurios_etl - WARNING - ⚠️ Warehouse inventory aggregation missing from sync response
2025-03-03 13:53:31 - mercurios_etl - WARNING - ⚠️ Warehouse inventory aggregation missing from sync response
2025-03-03 13:53:31 - mercurios_etl - INFO - 
===== TEST SUMMARY =====
2025-03-03 13:53:31 - mercurios_etl - INFO - 
===== TEST SUMMARY =====
2025-03-03 13:53:31 - mercurios_etl - INFO - Lambda Handler Test: ✅ PASS
2025-03-03 13:53:31 - mercurios_etl - INFO - Lambda Handler Test: ✅ PASS
2025-03-03 13:53:31 - mercurios_etl - INFO - Shop Mapping Test: ✅ PASS
2025-03-03 13:53:31 - mercurios_etl - INFO - Shop Mapping Test: ✅ PASS
2025-03-03 13:53:31 - mercurios_etl - INFO - Aggregations Test: ✅ PASS
2025-03-03 13:53:31 - mercurios_etl - INFO - Aggregations Test: ✅ PASS
2025-03-03 13:53:31 - mercurios_etl - INFO - 
Overall Test Status: ✅ PASS
2025-03-03 13:53:31 - mercurios_etl - INFO - 
Overall Test Status: ✅ PASS
2025-03-03 13:53:31 - mercurios_etl - INFO - 
🎉 The Lambda function is ready for deployment! 🎉
2025-03-03 13:53:31 - mercurios_etl - INFO - 
🎉 The Lambda function is ready for deployment! 🎉
2025-03-03 13:53:56 - mercurios_etl - INFO - Starting end-to-end tests for ProHandel Lambda function
2025-03-03 13:53:56 - mercurios_etl - INFO - Starting end-to-end tests for ProHandel Lambda function
2025-03-03 13:53:56 - mercurios_etl - INFO - ===== TESTING LAMBDA HANDLERS =====
2025-03-03 13:53:56 - mercurios_etl - INFO - ===== TESTING LAMBDA HANDLERS =====
2025-03-03 13:53:56 - mercurios_etl - INFO - Testing 'test' operation...
2025-03-03 13:53:56 - mercurios_etl - INFO - Testing 'test' operation...
2025-03-03 13:53:56 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 13:53:56 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 13:53:56 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:53:56 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:53:56 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:53:56 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:53:56 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:53:56 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:53:56 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:53:56 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:53:56 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:53:56 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:53:56 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 14:23:56.636470
2025-03-03 13:53:56 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 14:23:56.636470
2025-03-03 13:53:56 - mercurios_etl - INFO - ✅ Test operation successful
2025-03-03 13:53:56 - mercurios_etl - INFO - ✅ Test operation successful
2025-03-03 13:53:56 - mercurios_etl - INFO - Test response: {
  "status": "ok",
  "message": "Successfully connected to ProHandel API"
}
2025-03-03 13:53:56 - mercurios_etl - INFO - Test response: {
  "status": "ok",
  "message": "Successfully connected to ProHandel API"
}
2025-03-03 13:53:56 - mercurios_etl - INFO - Testing 'schema' operation...
2025-03-03 13:53:56 - mercurios_etl - INFO - Testing 'schema' operation...
2025-03-03 13:53:56 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 13:53:56 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 13:53:57 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 1)
2025-03-03 13:53:57 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 1)
2025-03-03 13:53:57 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 1)
2025-03-03 13:53:57 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 1)
2025-03-03 13:53:57 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 1)
2025-03-03 13:53:57 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 1)
2025-03-03 13:53:58 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 1)
2025-03-03 13:53:58 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 1)
2025-03-03 13:53:58 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 1)
2025-03-03 13:53:58 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching supplier data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching supplier data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching category data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching category data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching staff data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching staff data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching articlesize data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching articlesize data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching country data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching country data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching currency data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching currency data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching invoice data (page 1, pagesize 1)
2025-03-03 13:53:59 - mercurios_etl - INFO - Fetching invoice data (page 1, pagesize 1)
2025-03-03 13:54:00 - mercurios_etl - INFO - Fetching payment data (page 1, pagesize 1)
2025-03-03 13:54:00 - mercurios_etl - INFO - Fetching payment data (page 1, pagesize 1)
2025-03-03 13:54:00 - mercurios_etl - INFO - Fetching season data (page 1, pagesize 1)
2025-03-03 13:54:00 - mercurios_etl - INFO - Fetching season data (page 1, pagesize 1)
2025-03-03 13:54:00 - mercurios_etl - INFO - Fetching size data (page 1, pagesize 1)
2025-03-03 13:54:00 - mercurios_etl - INFO - Fetching size data (page 1, pagesize 1)
2025-03-03 13:54:00 - mercurios_etl - INFO - ✅ Schema operation successful, found 19 tables including 'shop'
2025-03-03 13:54:00 - mercurios_etl - INFO - ✅ Schema operation successful, found 19 tables including 'shop'
2025-03-03 13:54:00 - mercurios_etl - INFO - Testing 'sync' operation...
2025-03-03 13:54:00 - mercurios_etl - INFO - Testing 'sync' operation...
2025-03-03 13:54:00 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:54:00 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:54:00 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:54:00 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:54:01 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:54:01 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:54:02 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:54:02 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:54:03 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:54:03 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:54:03 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:54:03 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:54:04 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:54:04 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:54:04 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:54:04 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:54:04 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 13:54:04 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 13:54:04 - mercurios_etl - INFO - Sync response contains data for tables: article, customer, order, sale, inventory, shop, daily_sales_agg
2025-03-03 13:54:04 - mercurios_etl - INFO - Sync response contains data for tables: article, customer, order, sale, inventory, shop, daily_sales_agg
2025-03-03 13:54:04 - mercurios_etl - INFO - ✅ Found 5 shop records
2025-03-03 13:54:04 - mercurios_etl - INFO - ✅ Found 5 shop records
2025-03-03 13:54:04 - mercurios_etl - INFO - ✅ Found aggregation table 'daily_sales_agg' with 4 records
2025-03-03 13:54:04 - mercurios_etl - INFO - ✅ Found aggregation table 'daily_sales_agg' with 4 records
2025-03-03 13:54:04 - mercurios_etl - INFO - ✅ Sync operation successful
2025-03-03 13:54:04 - mercurios_etl - INFO - ✅ Sync operation successful
2025-03-03 13:54:04 - mercurios_etl - INFO - ===== VERIFYING SHOP MAPPING =====
2025-03-03 13:54:04 - mercurios_etl - INFO - ===== VERIFYING SHOP MAPPING =====
2025-03-03 13:54:04 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:54:04 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:54:04 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:54:04 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:54:04 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:54:04 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:54:05 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:54:05 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:54:06 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:54:06 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:54:07 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:54:07 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:54:07 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:54:07 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:54:07 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:54:07 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:54:07 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 13:54:07 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 13:54:07 - mercurios_etl - INFO - ✅ Shop mapping verified successfully with 5 records
2025-03-03 13:54:07 - mercurios_etl - INFO - ✅ Shop mapping verified successfully with 5 records
2025-03-03 13:54:07 - mercurios_etl - INFO - Sample shop record: {
  "stateNumber": 0,
  "isActive": true,
  "imageName": "",
  "bankCode": 0,
  "email": "neu00511323278",
  "fax": "",
  "id": "0f319673-6c29-4ed2-b28b-8886dd2a9a31",
  "iban": "",
  "glN1": 4399901477599.0,
  "glN2": 4399901477599.0,
  "branchInfo": "",
  "isWebshop": false,
  "stocktakingDate": "2016-03-31T00:00:00",
  "bankAccount": "509450000",
  "logoFileName": "",
  "searchTerm": "Filiale1",
  "name1": "I. G.von der Linde GmbH & CoKG",
  "name2": "",
  "name3": "",
  "number": 1,
  "city": "Hannover",
  "zipCode": "30167",
  "street": "An der Christuskirche 17",
  "bic": "",
  "telephoneNumber": "0511/36 606 0",
  "countryNumber": "D",
  "regionNumber": 0,
  "lastChange": "2022-03-29T15:33:33.3709455",
  "isDeleted": false,
  "openMonday": null,
  "openTuesday": null,
  "openWednesday": null,
  "openThursday": null,
  "openFriday": null,
  "openSaturday": null,
  "openSunday": null,
  "shop_type": "Retail",
  "is_online": false
}
2025-03-03 13:54:07 - mercurios_etl - INFO - Sample shop record: {
  "stateNumber": 0,
  "isActive": true,
  "imageName": "",
  "bankCode": 0,
  "email": "neu00511323278",
  "fax": "",
  "id": "0f319673-6c29-4ed2-b28b-8886dd2a9a31",
  "iban": "",
  "glN1": 4399901477599.0,
  "glN2": 4399901477599.0,
  "branchInfo": "",
  "isWebshop": false,
  "stocktakingDate": "2016-03-31T00:00:00",
  "bankAccount": "509450000",
  "logoFileName": "",
  "searchTerm": "Filiale1",
  "name1": "I. G.von der Linde GmbH & CoKG",
  "name2": "",
  "name3": "",
  "number": 1,
  "city": "Hannover",
  "zipCode": "30167",
  "street": "An der Christuskirche 17",
  "bic": "",
  "telephoneNumber": "0511/36 606 0",
  "countryNumber": "D",
  "regionNumber": 0,
  "lastChange": "2022-03-29T15:33:33.3709455",
  "isDeleted": false,
  "openMonday": null,
  "openTuesday": null,
  "openWednesday": null,
  "openThursday": null,
  "openFriday": null,
  "openSaturday": null,
  "openSunday": null,
  "shop_type": "Retail",
  "is_online": false
}
2025-03-03 13:54:07 - mercurios_etl - INFO - ===== VERIFYING AGGREGATIONS =====
2025-03-03 13:54:07 - mercurios_etl - INFO - ===== VERIFYING AGGREGATIONS =====
2025-03-03 13:54:07 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:54:07 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:54:07 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:54:07 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:54:08 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:54:08 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:54:08 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:54:08 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:54:10 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:54:10 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:54:11 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:54:11 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:54:11 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:54:11 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:54:11 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:54:11 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:54:11 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 13:54:11 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 13:54:11 - mercurios_etl - INFO - ✅ Found 4 daily sales aggregation records
2025-03-03 13:54:11 - mercurios_etl - INFO - ✅ Found 4 daily sales aggregation records
2025-03-03 13:54:11 - mercurios_etl - INFO - ✅ Daily sales aggregation structure verified
2025-03-03 13:54:11 - mercurios_etl - INFO - ✅ Daily sales aggregation structure verified
2025-03-03 13:54:11 - mercurios_etl - INFO - Sample daily sales aggregation: {
  "date": "2015-11-13",
  "total_quantity": 0.0,
  "sale_count": 6,
  "aggregation_type": "daily"
}
2025-03-03 13:54:11 - mercurios_etl - INFO - Sample daily sales aggregation: {
  "date": "2015-11-13",
  "total_quantity": 0.0,
  "sale_count": 6,
  "aggregation_type": "daily"
}
2025-03-03 13:54:11 - mercurios_etl - WARNING - ⚠️ Article sales aggregation missing from sync response
2025-03-03 13:54:11 - mercurios_etl - WARNING - ⚠️ Article sales aggregation missing from sync response
2025-03-03 13:54:11 - mercurios_etl - WARNING - ⚠️ Warehouse inventory aggregation missing from sync response
2025-03-03 13:54:11 - mercurios_etl - WARNING - ⚠️ Warehouse inventory aggregation missing from sync response
2025-03-03 13:54:11 - mercurios_etl - INFO - 
===== TEST SUMMARY =====
2025-03-03 13:54:11 - mercurios_etl - INFO - 
===== TEST SUMMARY =====
2025-03-03 13:54:11 - mercurios_etl - INFO - Lambda Handler Test: ✅ PASS
2025-03-03 13:54:11 - mercurios_etl - INFO - Lambda Handler Test: ✅ PASS
2025-03-03 13:54:11 - mercurios_etl - INFO - Shop Mapping Test: ✅ PASS
2025-03-03 13:54:11 - mercurios_etl - INFO - Shop Mapping Test: ✅ PASS
2025-03-03 13:54:11 - mercurios_etl - INFO - Aggregations Test: ✅ PASS
2025-03-03 13:54:11 - mercurios_etl - INFO - Aggregations Test: ✅ PASS
2025-03-03 13:54:11 - mercurios_etl - INFO - 
Overall Test Status: ✅ PASS
2025-03-03 13:54:11 - mercurios_etl - INFO - 
Overall Test Status: ✅ PASS
2025-03-03 13:54:11 - mercurios_etl - INFO - 
🎉 The Lambda function is ready for deployment! 🎉
2025-03-03 13:54:11 - mercurios_etl - INFO - 
🎉 The Lambda function is ready for deployment! 🎉
2025-03-03 13:57:36 - mercurios_etl - INFO - Starting end-to-end tests for ProHandel Lambda function
2025-03-03 13:57:36 - mercurios_etl - INFO - Starting end-to-end tests for ProHandel Lambda function
2025-03-03 13:57:36 - mercurios_etl - INFO - ===== TESTING LAMBDA HANDLERS =====
2025-03-03 13:57:36 - mercurios_etl - INFO - ===== TESTING LAMBDA HANDLERS =====
2025-03-03 13:57:36 - mercurios_etl - INFO - Testing 'test' operation...
2025-03-03 13:57:36 - mercurios_etl - INFO - Testing 'test' operation...
2025-03-03 13:57:36 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 13:57:36 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 13:57:36 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:57:36 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 13:57:36 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:57:36 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 13:57:36 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:57:36 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 13:57:36 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:57:36 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 13:57:36 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:57:36 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 13:57:36 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 14:27:36.650582
2025-03-03 13:57:36 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 14:27:36.650582
2025-03-03 13:57:36 - mercurios_etl - INFO - ✅ Test operation successful
2025-03-03 13:57:36 - mercurios_etl - INFO - ✅ Test operation successful
2025-03-03 13:57:36 - mercurios_etl - INFO - Test response: {
  "status": "ok",
  "message": "Successfully connected to ProHandel API"
}
2025-03-03 13:57:36 - mercurios_etl - INFO - Test response: {
  "status": "ok",
  "message": "Successfully connected to ProHandel API"
}
2025-03-03 13:57:36 - mercurios_etl - INFO - Testing 'schema' operation...
2025-03-03 13:57:36 - mercurios_etl - INFO - Testing 'schema' operation...
2025-03-03 13:57:36 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 13:57:36 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 13:57:36 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 1)
2025-03-03 13:57:36 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 1)
2025-03-03 13:57:37 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 1)
2025-03-03 13:57:37 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 1)
2025-03-03 13:57:38 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 1)
2025-03-03 13:57:38 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 1)
2025-03-03 13:57:40 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 1)
2025-03-03 13:57:40 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 1)
2025-03-03 13:57:40 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 1)
2025-03-03 13:57:40 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 1)
2025-03-03 13:57:40 - mercurios_etl - INFO - Fetching supplier data (page 1, pagesize 1)
2025-03-03 13:57:40 - mercurios_etl - INFO - Fetching supplier data (page 1, pagesize 1)
2025-03-03 13:57:40 - mercurios_etl - INFO - Fetching category data (page 1, pagesize 1)
2025-03-03 13:57:40 - mercurios_etl - INFO - Fetching category data (page 1, pagesize 1)
2025-03-03 13:57:41 - mercurios_etl - INFO - Fetching staff data (page 1, pagesize 1)
2025-03-03 13:57:41 - mercurios_etl - INFO - Fetching staff data (page 1, pagesize 1)
2025-03-03 13:57:41 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 1)
2025-03-03 13:57:41 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 1)
2025-03-03 13:57:41 - mercurios_etl - INFO - Fetching articlesize data (page 1, pagesize 1)
2025-03-03 13:57:41 - mercurios_etl - INFO - Fetching articlesize data (page 1, pagesize 1)
2025-03-03 13:57:41 - mercurios_etl - INFO - Fetching country data (page 1, pagesize 1)
2025-03-03 13:57:41 - mercurios_etl - INFO - Fetching country data (page 1, pagesize 1)
2025-03-03 13:57:41 - mercurios_etl - INFO - Fetching currency data (page 1, pagesize 1)
2025-03-03 13:57:41 - mercurios_etl - INFO - Fetching currency data (page 1, pagesize 1)
2025-03-03 13:57:41 - mercurios_etl - INFO - Fetching invoice data (page 1, pagesize 1)
2025-03-03 13:57:41 - mercurios_etl - INFO - Fetching invoice data (page 1, pagesize 1)
2025-03-03 13:57:41 - mercurios_etl - INFO - Fetching payment data (page 1, pagesize 1)
2025-03-03 13:57:41 - mercurios_etl - INFO - Fetching payment data (page 1, pagesize 1)
2025-03-03 13:57:42 - mercurios_etl - INFO - Fetching season data (page 1, pagesize 1)
2025-03-03 13:57:42 - mercurios_etl - INFO - Fetching season data (page 1, pagesize 1)
2025-03-03 13:57:42 - mercurios_etl - INFO - Fetching size data (page 1, pagesize 1)
2025-03-03 13:57:42 - mercurios_etl - INFO - Fetching size data (page 1, pagesize 1)
2025-03-03 13:57:42 - mercurios_etl - INFO - ✅ Schema operation successful, found 19 tables including 'shop'
2025-03-03 13:57:42 - mercurios_etl - INFO - ✅ Schema operation successful, found 19 tables including 'shop'
2025-03-03 13:57:42 - mercurios_etl - INFO - Testing 'sync' operation...
2025-03-03 13:57:42 - mercurios_etl - INFO - Testing 'sync' operation...
2025-03-03 13:57:42 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:57:42 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:57:42 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:57:42 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:57:42 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:57:42 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:57:44 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:57:44 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:57:45 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:57:45 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:57:45 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:57:45 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:57:45 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:57:45 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:57:45 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:57:45 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:57:45 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 13:57:45 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 13:57:45 - mercurios_etl - INFO - Sync response contains data for tables: article, customer, order, sale, inventory, shop, daily_sales_agg
2025-03-03 13:57:45 - mercurios_etl - INFO - Sync response contains data for tables: article, customer, order, sale, inventory, shop, daily_sales_agg
2025-03-03 13:57:45 - mercurios_etl - INFO - ✅ Found 5 shop records
2025-03-03 13:57:45 - mercurios_etl - INFO - ✅ Found 5 shop records
2025-03-03 13:57:45 - mercurios_etl - INFO - ✅ Found aggregation table 'daily_sales_agg' with 4 records
2025-03-03 13:57:45 - mercurios_etl - INFO - ✅ Found aggregation table 'daily_sales_agg' with 4 records
2025-03-03 13:57:45 - mercurios_etl - INFO - ✅ Sync operation successful
2025-03-03 13:57:45 - mercurios_etl - INFO - ✅ Sync operation successful
2025-03-03 13:57:45 - mercurios_etl - INFO - ===== VERIFYING SHOP MAPPING =====
2025-03-03 13:57:45 - mercurios_etl - INFO - ===== VERIFYING SHOP MAPPING =====
2025-03-03 13:57:45 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:57:45 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:57:46 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:57:46 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:57:46 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:57:46 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:57:47 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:57:47 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:57:48 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:57:48 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:57:48 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:57:48 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:57:49 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:57:49 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:57:49 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:57:49 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:57:49 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 13:57:49 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 13:57:49 - mercurios_etl - INFO - ✅ Shop mapping verified successfully with 5 records
2025-03-03 13:57:49 - mercurios_etl - INFO - ✅ Shop mapping verified successfully with 5 records
2025-03-03 13:57:49 - mercurios_etl - INFO - Sample shop record: {
  "stateNumber": 0,
  "isActive": true,
  "imageName": "",
  "bankCode": 0,
  "email": "neu00511323278",
  "fax": "",
  "id": "0f319673-6c29-4ed2-b28b-8886dd2a9a31",
  "iban": "",
  "glN1": 4399901477599.0,
  "glN2": 4399901477599.0,
  "branchInfo": "",
  "isWebshop": false,
  "stocktakingDate": "2016-03-31T00:00:00",
  "bankAccount": "509450000",
  "logoFileName": "",
  "searchTerm": "Filiale1",
  "name1": "I. G.von der Linde GmbH & CoKG",
  "name2": "",
  "name3": "",
  "number": 1,
  "city": "Hannover",
  "zipCode": "30167",
  "street": "An der Christuskirche 17",
  "bic": "",
  "telephoneNumber": "0511/36 606 0",
  "countryNumber": "D",
  "regionNumber": 0,
  "lastChange": "2022-03-29T15:33:33.3709455",
  "isDeleted": false,
  "openMonday": null,
  "openTuesday": null,
  "openWednesday": null,
  "openThursday": null,
  "openFriday": null,
  "openSaturday": null,
  "openSunday": null,
  "shop_type": "Retail",
  "is_online": false
}
2025-03-03 13:57:49 - mercurios_etl - INFO - Sample shop record: {
  "stateNumber": 0,
  "isActive": true,
  "imageName": "",
  "bankCode": 0,
  "email": "neu00511323278",
  "fax": "",
  "id": "0f319673-6c29-4ed2-b28b-8886dd2a9a31",
  "iban": "",
  "glN1": 4399901477599.0,
  "glN2": 4399901477599.0,
  "branchInfo": "",
  "isWebshop": false,
  "stocktakingDate": "2016-03-31T00:00:00",
  "bankAccount": "509450000",
  "logoFileName": "",
  "searchTerm": "Filiale1",
  "name1": "I. G.von der Linde GmbH & CoKG",
  "name2": "",
  "name3": "",
  "number": 1,
  "city": "Hannover",
  "zipCode": "30167",
  "street": "An der Christuskirche 17",
  "bic": "",
  "telephoneNumber": "0511/36 606 0",
  "countryNumber": "D",
  "regionNumber": 0,
  "lastChange": "2022-03-29T15:33:33.3709455",
  "isDeleted": false,
  "openMonday": null,
  "openTuesday": null,
  "openWednesday": null,
  "openThursday": null,
  "openFriday": null,
  "openSaturday": null,
  "openSunday": null,
  "shop_type": "Retail",
  "is_online": false
}
2025-03-03 13:57:49 - mercurios_etl - INFO - ===== VERIFYING AGGREGATIONS =====
2025-03-03 13:57:49 - mercurios_etl - INFO - ===== VERIFYING AGGREGATIONS =====
2025-03-03 13:57:49 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:57:49 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 13:57:49 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:57:49 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 13:57:49 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:57:49 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 13:57:51 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:57:51 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 13:57:53 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:57:53 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 13:57:53 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:57:53 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 13:57:53 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:57:53 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 13:57:53 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:57:53 - mercurios_etl - ERROR - Error during article sales aggregation: cannot insert articleNumber, already exists
2025-03-03 13:57:53 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 13:57:53 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 13:57:53 - mercurios_etl - INFO - ✅ Found 4 daily sales aggregation records
2025-03-03 13:57:53 - mercurios_etl - INFO - ✅ Found 4 daily sales aggregation records
2025-03-03 13:57:53 - mercurios_etl - INFO - ✅ Daily sales aggregation structure verified
2025-03-03 13:57:53 - mercurios_etl - INFO - ✅ Daily sales aggregation structure verified
2025-03-03 13:57:53 - mercurios_etl - INFO - Sample daily sales aggregation: {
  "date": "2015-11-13",
  "total_quantity": 0.0,
  "sale_count": 6,
  "aggregation_type": "daily"
}
2025-03-03 13:57:53 - mercurios_etl - INFO - Sample daily sales aggregation: {
  "date": "2015-11-13",
  "total_quantity": 0.0,
  "sale_count": 6,
  "aggregation_type": "daily"
}
2025-03-03 13:57:53 - mercurios_etl - WARNING - ⚠️ Article sales aggregation missing from sync response
2025-03-03 13:57:53 - mercurios_etl - WARNING - ⚠️ Article sales aggregation missing from sync response
2025-03-03 13:57:53 - mercurios_etl - WARNING - ⚠️ Warehouse inventory aggregation missing from sync response
2025-03-03 13:57:53 - mercurios_etl - WARNING - ⚠️ Warehouse inventory aggregation missing from sync response
2025-03-03 13:57:53 - mercurios_etl - INFO - 
===== TEST SUMMARY =====
2025-03-03 13:57:53 - mercurios_etl - INFO - 
===== TEST SUMMARY =====
2025-03-03 13:57:53 - mercurios_etl - INFO - Lambda Handler Test: ✅ PASS
2025-03-03 13:57:53 - mercurios_etl - INFO - Lambda Handler Test: ✅ PASS
2025-03-03 13:57:53 - mercurios_etl - INFO - Shop Mapping Test: ✅ PASS
2025-03-03 13:57:53 - mercurios_etl - INFO - Shop Mapping Test: ✅ PASS
2025-03-03 13:57:53 - mercurios_etl - INFO - Aggregations Test: ✅ PASS
2025-03-03 13:57:53 - mercurios_etl - INFO - Aggregations Test: ✅ PASS
2025-03-03 13:57:53 - mercurios_etl - INFO - 
Overall Test Status: ✅ PASS
2025-03-03 13:57:53 - mercurios_etl - INFO - 
Overall Test Status: ✅ PASS
2025-03-03 13:57:53 - mercurios_etl - INFO - 
🎉 The Lambda function is ready for deployment! 🎉
2025-03-03 13:57:53 - mercurios_etl - INFO - 
🎉 The Lambda function is ready for deployment! 🎉
2025-03-03 14:02:40 - mercurios_etl - INFO - Starting end-to-end tests for ProHandel Lambda function
2025-03-03 14:02:40 - mercurios_etl - INFO - Starting end-to-end tests for ProHandel Lambda function
2025-03-03 14:02:40 - mercurios_etl - INFO - ===== TESTING LAMBDA HANDLERS =====
2025-03-03 14:02:40 - mercurios_etl - INFO - ===== TESTING LAMBDA HANDLERS =====
2025-03-03 14:02:40 - mercurios_etl - INFO - Testing 'test' operation...
2025-03-03 14:02:40 - mercurios_etl - INFO - Testing 'test' operation...
2025-03-03 14:02:40 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 14:02:40 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 14:02:40 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 14:02:40 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 14:02:40 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 14:02:40 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 14:02:41 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 14:02:41 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 14:02:41 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 14:02:41 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 14:02:41 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 14:02:41 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 14:02:41 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 14:32:41.216721
2025-03-03 14:02:41 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 14:32:41.216721
2025-03-03 14:02:41 - mercurios_etl - INFO - ✅ Test operation successful
2025-03-03 14:02:41 - mercurios_etl - INFO - ✅ Test operation successful
2025-03-03 14:02:41 - mercurios_etl - INFO - Test response: {
  "status": "ok",
  "message": "Successfully connected to ProHandel API"
}
2025-03-03 14:02:41 - mercurios_etl - INFO - Test response: {
  "status": "ok",
  "message": "Successfully connected to ProHandel API"
}
2025-03-03 14:02:41 - mercurios_etl - INFO - Testing 'schema' operation...
2025-03-03 14:02:41 - mercurios_etl - INFO - Testing 'schema' operation...
2025-03-03 14:02:41 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 14:02:41 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 14:02:41 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 1)
2025-03-03 14:02:41 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 1)
2025-03-03 14:02:41 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 1)
2025-03-03 14:02:41 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 1)
2025-03-03 14:02:41 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 1)
2025-03-03 14:02:41 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 1)
2025-03-03 14:02:43 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 1)
2025-03-03 14:02:43 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 1)
2025-03-03 14:02:43 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 1)
2025-03-03 14:02:43 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 1)
2025-03-03 14:02:43 - mercurios_etl - INFO - Fetching supplier data (page 1, pagesize 1)
2025-03-03 14:02:43 - mercurios_etl - INFO - Fetching supplier data (page 1, pagesize 1)
2025-03-03 14:02:43 - mercurios_etl - INFO - Fetching category data (page 1, pagesize 1)
2025-03-03 14:02:43 - mercurios_etl - INFO - Fetching category data (page 1, pagesize 1)
2025-03-03 14:02:43 - mercurios_etl - INFO - Fetching staff data (page 1, pagesize 1)
2025-03-03 14:02:43 - mercurios_etl - INFO - Fetching staff data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching articlesize data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching articlesize data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching country data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching country data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching currency data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching currency data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching invoice data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching invoice data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching payment data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching payment data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching season data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching season data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching size data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching size data (page 1, pagesize 1)
2025-03-03 14:02:44 - mercurios_etl - INFO - ✅ Schema operation successful, found 19 tables including 'shop'
2025-03-03 14:02:44 - mercurios_etl - INFO - ✅ Schema operation successful, found 19 tables including 'shop'
2025-03-03 14:02:44 - mercurios_etl - INFO - Testing 'sync' operation...
2025-03-03 14:02:44 - mercurios_etl - INFO - Testing 'sync' operation...
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:02:44 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:02:45 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:02:45 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:02:45 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:02:45 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:02:46 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:02:46 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:02:48 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:02:48 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:02:48 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:02:48 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:02:48 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:02:48 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:02:48 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:02:48 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:02:48 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 14:02:48 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 14:02:48 - mercurios_etl - INFO - Sync response contains data for tables: article, customer, order, sale, inventory, shop, daily_sales_agg, article_sales_agg
2025-03-03 14:02:48 - mercurios_etl - INFO - Sync response contains data for tables: article, customer, order, sale, inventory, shop, daily_sales_agg, article_sales_agg
2025-03-03 14:02:48 - mercurios_etl - INFO - ✅ Found 5 shop records
2025-03-03 14:02:48 - mercurios_etl - INFO - ✅ Found 5 shop records
2025-03-03 14:02:48 - mercurios_etl - INFO - ✅ Found aggregation table 'daily_sales_agg' with 4 records
2025-03-03 14:02:48 - mercurios_etl - INFO - ✅ Found aggregation table 'daily_sales_agg' with 4 records
2025-03-03 14:02:48 - mercurios_etl - INFO - ✅ Found aggregation table 'article_sales_agg' with 118 records
2025-03-03 14:02:48 - mercurios_etl - INFO - ✅ Found aggregation table 'article_sales_agg' with 118 records
2025-03-03 14:02:48 - mercurios_etl - INFO - ✅ Sync operation successful
2025-03-03 14:02:48 - mercurios_etl - INFO - ✅ Sync operation successful
2025-03-03 14:02:48 - mercurios_etl - INFO - ===== VERIFYING SHOP MAPPING =====
2025-03-03 14:02:48 - mercurios_etl - INFO - ===== VERIFYING SHOP MAPPING =====
2025-03-03 14:02:48 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:02:48 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:02:48 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:02:48 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:02:49 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:02:49 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:02:50 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:02:50 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:02:51 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:02:51 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:02:51 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:02:51 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:02:52 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:02:52 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:02:52 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:02:52 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:02:52 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 14:02:52 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 14:02:52 - mercurios_etl - INFO - ✅ Shop mapping verified successfully with 5 records
2025-03-03 14:02:52 - mercurios_etl - INFO - ✅ Shop mapping verified successfully with 5 records
2025-03-03 14:02:52 - mercurios_etl - INFO - Sample shop record: {
  "stateNumber": 0,
  "isActive": true,
  "imageName": "",
  "bankCode": 0,
  "email": "neu00511323278",
  "fax": "",
  "id": "0f319673-6c29-4ed2-b28b-8886dd2a9a31",
  "iban": "",
  "glN1": 4399901477599.0,
  "glN2": 4399901477599.0,
  "branchInfo": "",
  "isWebshop": false,
  "stocktakingDate": "2016-03-31T00:00:00",
  "bankAccount": "509450000",
  "logoFileName": "",
  "searchTerm": "Filiale1",
  "name1": "I. G.von der Linde GmbH & CoKG",
  "name2": "",
  "name3": "",
  "number": 1,
  "city": "Hannover",
  "zipCode": "30167",
  "street": "An der Christuskirche 17",
  "bic": "",
  "telephoneNumber": "0511/36 606 0",
  "countryNumber": "D",
  "regionNumber": 0,
  "lastChange": "2022-03-29T15:33:33.3709455",
  "isDeleted": false,
  "openMonday": null,
  "openTuesday": null,
  "openWednesday": null,
  "openThursday": null,
  "openFriday": null,
  "openSaturday": null,
  "openSunday": null,
  "shop_type": "Retail",
  "is_online": false
}
2025-03-03 14:02:52 - mercurios_etl - INFO - Sample shop record: {
  "stateNumber": 0,
  "isActive": true,
  "imageName": "",
  "bankCode": 0,
  "email": "neu00511323278",
  "fax": "",
  "id": "0f319673-6c29-4ed2-b28b-8886dd2a9a31",
  "iban": "",
  "glN1": 4399901477599.0,
  "glN2": 4399901477599.0,
  "branchInfo": "",
  "isWebshop": false,
  "stocktakingDate": "2016-03-31T00:00:00",
  "bankAccount": "509450000",
  "logoFileName": "",
  "searchTerm": "Filiale1",
  "name1": "I. G.von der Linde GmbH & CoKG",
  "name2": "",
  "name3": "",
  "number": 1,
  "city": "Hannover",
  "zipCode": "30167",
  "street": "An der Christuskirche 17",
  "bic": "",
  "telephoneNumber": "0511/36 606 0",
  "countryNumber": "D",
  "regionNumber": 0,
  "lastChange": "2022-03-29T15:33:33.3709455",
  "isDeleted": false,
  "openMonday": null,
  "openTuesday": null,
  "openWednesday": null,
  "openThursday": null,
  "openFriday": null,
  "openSaturday": null,
  "openSunday": null,
  "shop_type": "Retail",
  "is_online": false
}
2025-03-03 14:02:52 - mercurios_etl - INFO - ===== VERIFYING AGGREGATIONS =====
2025-03-03 14:02:52 - mercurios_etl - INFO - ===== VERIFYING AGGREGATIONS =====
2025-03-03 14:02:52 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:02:52 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:02:52 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:02:52 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:02:52 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:02:52 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:02:53 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:02:53 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:02:55 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:02:55 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:02:55 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:02:55 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:02:55 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:02:55 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:02:55 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:02:55 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:02:55 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 14:02:55 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 14:02:55 - mercurios_etl - INFO - ✅ Found 4 daily sales aggregation records
2025-03-03 14:02:55 - mercurios_etl - INFO - ✅ Found 4 daily sales aggregation records
2025-03-03 14:02:55 - mercurios_etl - INFO - ✅ Daily sales aggregation structure verified
2025-03-03 14:02:55 - mercurios_etl - INFO - ✅ Daily sales aggregation structure verified
2025-03-03 14:02:55 - mercurios_etl - INFO - Sample daily sales aggregation: {
  "date": "2015-11-13",
  "total_quantity": 0.0,
  "sale_count": 6,
  "aggregation_type": "daily"
}
2025-03-03 14:02:55 - mercurios_etl - INFO - Sample daily sales aggregation: {
  "date": "2015-11-13",
  "total_quantity": 0.0,
  "sale_count": 6,
  "aggregation_type": "daily"
}
2025-03-03 14:02:55 - mercurios_etl - INFO - ✅ Found 118 article sales aggregation records
2025-03-03 14:02:55 - mercurios_etl - INFO - ✅ Found 118 article sales aggregation records
2025-03-03 14:02:55 - mercurios_etl - WARNING - ⚠️ Warehouse inventory aggregation missing from sync response
2025-03-03 14:02:55 - mercurios_etl - WARNING - ⚠️ Warehouse inventory aggregation missing from sync response
2025-03-03 14:02:55 - mercurios_etl - INFO - 
===== TEST SUMMARY =====
2025-03-03 14:02:55 - mercurios_etl - INFO - 
===== TEST SUMMARY =====
2025-03-03 14:02:55 - mercurios_etl - INFO - Lambda Handler Test: ✅ PASS
2025-03-03 14:02:55 - mercurios_etl - INFO - Lambda Handler Test: ✅ PASS
2025-03-03 14:02:55 - mercurios_etl - INFO - Shop Mapping Test: ✅ PASS
2025-03-03 14:02:55 - mercurios_etl - INFO - Shop Mapping Test: ✅ PASS
2025-03-03 14:02:55 - mercurios_etl - INFO - Aggregations Test: ✅ PASS
2025-03-03 14:02:55 - mercurios_etl - INFO - Aggregations Test: ✅ PASS
2025-03-03 14:02:55 - mercurios_etl - INFO - 
Overall Test Status: ✅ PASS
2025-03-03 14:02:55 - mercurios_etl - INFO - 
Overall Test Status: ✅ PASS
2025-03-03 14:02:55 - mercurios_etl - INFO - 
🎉 The Lambda function is ready for deployment! 🎉
2025-03-03 14:02:55 - mercurios_etl - INFO - 
🎉 The Lambda function is ready for deployment! 🎉
2025-03-03 14:03:28 - mercurios_etl - INFO - Starting end-to-end tests for ProHandel Lambda function
2025-03-03 14:03:28 - mercurios_etl - INFO - Starting end-to-end tests for ProHandel Lambda function
2025-03-03 14:03:28 - mercurios_etl - INFO - ===== TESTING LAMBDA HANDLERS =====
2025-03-03 14:03:28 - mercurios_etl - INFO - ===== TESTING LAMBDA HANDLERS =====
2025-03-03 14:03:28 - mercurios_etl - INFO - Testing 'test' operation...
2025-03-03 14:03:28 - mercurios_etl - INFO - Testing 'test' operation...
2025-03-03 14:03:28 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 14:03:28 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 14:03:28 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 14:03:28 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 14:03:28 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 14:03:28 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 14:03:28 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 14:03:28 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 14:03:28 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 14:03:28 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 14:03:28 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 14:03:28 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 14:03:28 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 14:33:28.932601
2025-03-03 14:03:28 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 14:33:28.932601
2025-03-03 14:03:29 - mercurios_etl - INFO - ✅ Test operation successful
2025-03-03 14:03:29 - mercurios_etl - INFO - ✅ Test operation successful
2025-03-03 14:03:29 - mercurios_etl - INFO - Test response: {
  "status": "ok",
  "message": "Successfully connected to ProHandel API"
}
2025-03-03 14:03:29 - mercurios_etl - INFO - Test response: {
  "status": "ok",
  "message": "Successfully connected to ProHandel API"
}
2025-03-03 14:03:29 - mercurios_etl - INFO - Testing 'schema' operation...
2025-03-03 14:03:29 - mercurios_etl - INFO - Testing 'schema' operation...
2025-03-03 14:03:29 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 14:03:29 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 14:03:29 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 1)
2025-03-03 14:03:29 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 1)
2025-03-03 14:03:29 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 1)
2025-03-03 14:03:29 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 1)
2025-03-03 14:03:29 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 1)
2025-03-03 14:03:29 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 1)
2025-03-03 14:03:32 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 1)
2025-03-03 14:03:32 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 1)
2025-03-03 14:03:32 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 1)
2025-03-03 14:03:32 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 1)
2025-03-03 14:03:32 - mercurios_etl - INFO - Fetching supplier data (page 1, pagesize 1)
2025-03-03 14:03:32 - mercurios_etl - INFO - Fetching supplier data (page 1, pagesize 1)
2025-03-03 14:03:32 - mercurios_etl - INFO - Fetching category data (page 1, pagesize 1)
2025-03-03 14:03:32 - mercurios_etl - INFO - Fetching category data (page 1, pagesize 1)
2025-03-03 14:03:32 - mercurios_etl - INFO - Fetching staff data (page 1, pagesize 1)
2025-03-03 14:03:32 - mercurios_etl - INFO - Fetching staff data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching articlesize data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching articlesize data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching country data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching country data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching currency data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching currency data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching invoice data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching invoice data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching payment data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching payment data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching season data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching season data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching size data (page 1, pagesize 1)
2025-03-03 14:03:33 - mercurios_etl - INFO - Fetching size data (page 1, pagesize 1)
2025-03-03 14:03:34 - mercurios_etl - INFO - ✅ Schema operation successful, found 19 tables including 'shop'
2025-03-03 14:03:34 - mercurios_etl - INFO - ✅ Schema operation successful, found 19 tables including 'shop'
2025-03-03 14:03:34 - mercurios_etl - INFO - Testing 'sync' operation...
2025-03-03 14:03:34 - mercurios_etl - INFO - Testing 'sync' operation...
2025-03-03 14:03:34 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:03:34 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:03:34 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:03:34 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:03:34 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:03:34 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:03:35 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:03:35 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:03:37 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:03:37 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:03:37 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:03:37 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:03:37 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:03:37 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:03:37 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:03:37 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:03:37 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 14:03:37 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 14:03:37 - mercurios_etl - INFO - Added 1 warehouse inventory aggregation records
2025-03-03 14:03:37 - mercurios_etl - INFO - Added 1 warehouse inventory aggregation records
2025-03-03 14:03:37 - mercurios_etl - INFO - Sync response contains data for tables: article, customer, order, sale, inventory, shop, daily_sales_agg, article_sales_agg, warehouse_inventory_agg
2025-03-03 14:03:37 - mercurios_etl - INFO - Sync response contains data for tables: article, customer, order, sale, inventory, shop, daily_sales_agg, article_sales_agg, warehouse_inventory_agg
2025-03-03 14:03:37 - mercurios_etl - INFO - ✅ Found 5 shop records
2025-03-03 14:03:37 - mercurios_etl - INFO - ✅ Found 5 shop records
2025-03-03 14:03:37 - mercurios_etl - INFO - ✅ Found aggregation table 'daily_sales_agg' with 4 records
2025-03-03 14:03:37 - mercurios_etl - INFO - ✅ Found aggregation table 'daily_sales_agg' with 4 records
2025-03-03 14:03:37 - mercurios_etl - INFO - ✅ Found aggregation table 'article_sales_agg' with 118 records
2025-03-03 14:03:37 - mercurios_etl - INFO - ✅ Found aggregation table 'article_sales_agg' with 118 records
2025-03-03 14:03:37 - mercurios_etl - INFO - ✅ Found aggregation table 'warehouse_inventory_agg' with 1 records
2025-03-03 14:03:37 - mercurios_etl - INFO - ✅ Found aggregation table 'warehouse_inventory_agg' with 1 records
2025-03-03 14:03:37 - mercurios_etl - INFO - ✅ Sync operation successful
2025-03-03 14:03:37 - mercurios_etl - INFO - ✅ Sync operation successful
2025-03-03 14:03:37 - mercurios_etl - INFO - ===== VERIFYING SHOP MAPPING =====
2025-03-03 14:03:37 - mercurios_etl - INFO - ===== VERIFYING SHOP MAPPING =====
2025-03-03 14:03:37 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:03:37 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:03:38 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:03:38 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:03:38 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:03:38 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:03:41 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:03:41 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:03:43 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:03:43 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:03:43 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:03:43 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:03:43 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:03:43 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:03:43 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:03:43 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:03:43 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 14:03:43 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 14:03:43 - mercurios_etl - INFO - Added 1 warehouse inventory aggregation records
2025-03-03 14:03:43 - mercurios_etl - INFO - Added 1 warehouse inventory aggregation records
2025-03-03 14:03:43 - mercurios_etl - INFO - ✅ Shop mapping verified successfully with 5 records
2025-03-03 14:03:43 - mercurios_etl - INFO - ✅ Shop mapping verified successfully with 5 records
2025-03-03 14:03:43 - mercurios_etl - INFO - Sample shop record: {
  "stateNumber": 0,
  "isActive": true,
  "imageName": "",
  "bankCode": 0,
  "email": "neu00511323278",
  "fax": "",
  "id": "0f319673-6c29-4ed2-b28b-8886dd2a9a31",
  "iban": "",
  "glN1": 4399901477599.0,
  "glN2": 4399901477599.0,
  "branchInfo": "",
  "isWebshop": false,
  "stocktakingDate": "2016-03-31T00:00:00",
  "bankAccount": "509450000",
  "logoFileName": "",
  "searchTerm": "Filiale1",
  "name1": "I. G.von der Linde GmbH & CoKG",
  "name2": "",
  "name3": "",
  "number": 1,
  "city": "Hannover",
  "zipCode": "30167",
  "street": "An der Christuskirche 17",
  "bic": "",
  "telephoneNumber": "0511/36 606 0",
  "countryNumber": "D",
  "regionNumber": 0,
  "lastChange": "2022-03-29T15:33:33.3709455",
  "isDeleted": false,
  "openMonday": null,
  "openTuesday": null,
  "openWednesday": null,
  "openThursday": null,
  "openFriday": null,
  "openSaturday": null,
  "openSunday": null,
  "shop_type": "Retail",
  "is_online": false
}
2025-03-03 14:03:43 - mercurios_etl - INFO - Sample shop record: {
  "stateNumber": 0,
  "isActive": true,
  "imageName": "",
  "bankCode": 0,
  "email": "neu00511323278",
  "fax": "",
  "id": "0f319673-6c29-4ed2-b28b-8886dd2a9a31",
  "iban": "",
  "glN1": 4399901477599.0,
  "glN2": 4399901477599.0,
  "branchInfo": "",
  "isWebshop": false,
  "stocktakingDate": "2016-03-31T00:00:00",
  "bankAccount": "509450000",
  "logoFileName": "",
  "searchTerm": "Filiale1",
  "name1": "I. G.von der Linde GmbH & CoKG",
  "name2": "",
  "name3": "",
  "number": 1,
  "city": "Hannover",
  "zipCode": "30167",
  "street": "An der Christuskirche 17",
  "bic": "",
  "telephoneNumber": "0511/36 606 0",
  "countryNumber": "D",
  "regionNumber": 0,
  "lastChange": "2022-03-29T15:33:33.3709455",
  "isDeleted": false,
  "openMonday": null,
  "openTuesday": null,
  "openWednesday": null,
  "openThursday": null,
  "openFriday": null,
  "openSaturday": null,
  "openSunday": null,
  "shop_type": "Retail",
  "is_online": false
}
2025-03-03 14:03:43 - mercurios_etl - INFO - ===== VERIFYING AGGREGATIONS =====
2025-03-03 14:03:43 - mercurios_etl - INFO - ===== VERIFYING AGGREGATIONS =====
2025-03-03 14:03:43 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:03:43 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:03:43 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:03:43 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:03:44 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:03:44 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:03:45 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:03:45 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:03:46 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:03:46 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:03:47 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:03:47 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:03:47 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:03:47 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:03:47 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:03:47 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:03:47 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 14:03:47 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 14:03:47 - mercurios_etl - INFO - Added 1 warehouse inventory aggregation records
2025-03-03 14:03:47 - mercurios_etl - INFO - Added 1 warehouse inventory aggregation records
2025-03-03 14:03:47 - mercurios_etl - INFO - ✅ Found 4 daily sales aggregation records
2025-03-03 14:03:47 - mercurios_etl - INFO - ✅ Found 4 daily sales aggregation records
2025-03-03 14:03:47 - mercurios_etl - INFO - ✅ Daily sales aggregation structure verified
2025-03-03 14:03:47 - mercurios_etl - INFO - ✅ Daily sales aggregation structure verified
2025-03-03 14:03:47 - mercurios_etl - INFO - Sample daily sales aggregation: {
  "date": "2015-11-13",
  "total_quantity": 0.0,
  "sale_count": 6,
  "aggregation_type": "daily"
}
2025-03-03 14:03:47 - mercurios_etl - INFO - Sample daily sales aggregation: {
  "date": "2015-11-13",
  "total_quantity": 0.0,
  "sale_count": 6,
  "aggregation_type": "daily"
}
2025-03-03 14:03:47 - mercurios_etl - INFO - ✅ Found 118 article sales aggregation records
2025-03-03 14:03:47 - mercurios_etl - INFO - ✅ Found 118 article sales aggregation records
2025-03-03 14:03:47 - mercurios_etl - INFO - ✅ Found 1 warehouse inventory aggregation records
2025-03-03 14:03:47 - mercurios_etl - INFO - ✅ Found 1 warehouse inventory aggregation records
2025-03-03 14:03:47 - mercurios_etl - INFO - 
===== TEST SUMMARY =====
2025-03-03 14:03:47 - mercurios_etl - INFO - 
===== TEST SUMMARY =====
2025-03-03 14:03:47 - mercurios_etl - INFO - Lambda Handler Test: ✅ PASS
2025-03-03 14:03:47 - mercurios_etl - INFO - Lambda Handler Test: ✅ PASS
2025-03-03 14:03:47 - mercurios_etl - INFO - Shop Mapping Test: ✅ PASS
2025-03-03 14:03:47 - mercurios_etl - INFO - Shop Mapping Test: ✅ PASS
2025-03-03 14:03:47 - mercurios_etl - INFO - Aggregations Test: ✅ PASS
2025-03-03 14:03:47 - mercurios_etl - INFO - Aggregations Test: ✅ PASS
2025-03-03 14:03:47 - mercurios_etl - INFO - 
Overall Test Status: ✅ PASS
2025-03-03 14:03:47 - mercurios_etl - INFO - 
Overall Test Status: ✅ PASS
2025-03-03 14:03:47 - mercurios_etl - INFO - 
🎉 The Lambda function is ready for deployment! 🎉
2025-03-03 14:03:47 - mercurios_etl - INFO - 
🎉 The Lambda function is ready for deployment! 🎉
2025-03-03 14:05:29 - mercurios_etl - INFO - Starting end-to-end tests for ProHandel Lambda function
2025-03-03 14:05:29 - mercurios_etl - INFO - Starting end-to-end tests for ProHandel Lambda function
2025-03-03 14:05:29 - mercurios_etl - INFO - ===== TESTING LAMBDA HANDLERS =====
2025-03-03 14:05:29 - mercurios_etl - INFO - ===== TESTING LAMBDA HANDLERS =====
2025-03-03 14:05:29 - mercurios_etl - INFO - Testing 'test' operation...
2025-03-03 14:05:29 - mercurios_etl - INFO - Testing 'test' operation...
2025-03-03 14:05:29 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 14:05:29 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 14:05:29 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 14:05:29 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-03 14:05:29 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 14:05:29 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-03 14:05:29 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 14:05:29 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-03 14:05:29 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 14:05:29 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-03 14:05:29 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 14:05:29 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-03 14:05:29 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 14:35:29.418800
2025-03-03 14:05:29 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-03 14:35:29.418800
2025-03-03 14:05:29 - mercurios_etl - INFO - ✅ Test operation successful
2025-03-03 14:05:29 - mercurios_etl - INFO - ✅ Test operation successful
2025-03-03 14:05:29 - mercurios_etl - INFO - Test response: {
  "status": "ok",
  "message": "Successfully connected to ProHandel API"
}
2025-03-03 14:05:29 - mercurios_etl - INFO - Test response: {
  "status": "ok",
  "message": "Successfully connected to ProHandel API"
}
2025-03-03 14:05:29 - mercurios_etl - INFO - Testing 'schema' operation...
2025-03-03 14:05:29 - mercurios_etl - INFO - Testing 'schema' operation...
2025-03-03 14:05:29 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 14:05:29 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 1)
2025-03-03 14:05:29 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 1)
2025-03-03 14:05:29 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 1)
2025-03-03 14:05:29 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 1)
2025-03-03 14:05:29 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 1)
2025-03-03 14:05:30 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 1)
2025-03-03 14:05:30 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching supplier data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching supplier data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching category data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching category data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching staff data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching staff data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching articlesize data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching articlesize data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching country data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching country data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching currency data (page 1, pagesize 1)
2025-03-03 14:05:31 - mercurios_etl - INFO - Fetching currency data (page 1, pagesize 1)
2025-03-03 14:05:32 - mercurios_etl - INFO - Fetching invoice data (page 1, pagesize 1)
2025-03-03 14:05:32 - mercurios_etl - INFO - Fetching invoice data (page 1, pagesize 1)
2025-03-03 14:05:32 - mercurios_etl - INFO - Fetching payment data (page 1, pagesize 1)
2025-03-03 14:05:32 - mercurios_etl - INFO - Fetching payment data (page 1, pagesize 1)
2025-03-03 14:05:32 - mercurios_etl - INFO - Fetching season data (page 1, pagesize 1)
2025-03-03 14:05:32 - mercurios_etl - INFO - Fetching season data (page 1, pagesize 1)
2025-03-03 14:05:32 - mercurios_etl - INFO - Fetching size data (page 1, pagesize 1)
2025-03-03 14:05:32 - mercurios_etl - INFO - Fetching size data (page 1, pagesize 1)
2025-03-03 14:05:32 - mercurios_etl - INFO - ✅ Schema operation successful, found 19 tables including 'shop'
2025-03-03 14:05:32 - mercurios_etl - INFO - ✅ Schema operation successful, found 19 tables including 'shop'
2025-03-03 14:05:32 - mercurios_etl - INFO - Testing 'sync' operation...
2025-03-03 14:05:32 - mercurios_etl - INFO - Testing 'sync' operation...
2025-03-03 14:05:32 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:05:32 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:05:32 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:05:32 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:05:33 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:05:33 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:05:34 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:05:34 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:05:35 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:05:35 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:05:35 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:05:35 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:05:36 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:05:36 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:05:36 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:05:36 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:05:36 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 14:05:36 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 14:05:36 - mercurios_etl - INFO - Added 1 warehouse inventory aggregation records
2025-03-03 14:05:36 - mercurios_etl - INFO - Added 1 warehouse inventory aggregation records
2025-03-03 14:05:36 - mercurios_etl - INFO - Sync response contains data for tables: article, customer, order, sale, inventory, shop, daily_sales_agg, article_sales_agg, warehouse_inventory_agg
2025-03-03 14:05:36 - mercurios_etl - INFO - Sync response contains data for tables: article, customer, order, sale, inventory, shop, daily_sales_agg, article_sales_agg, warehouse_inventory_agg
2025-03-03 14:05:36 - mercurios_etl - INFO - ✅ Found 5 shop records
2025-03-03 14:05:36 - mercurios_etl - INFO - ✅ Found 5 shop records
2025-03-03 14:05:36 - mercurios_etl - INFO - ✅ Found aggregation table 'daily_sales_agg' with 4 records
2025-03-03 14:05:36 - mercurios_etl - INFO - ✅ Found aggregation table 'daily_sales_agg' with 4 records
2025-03-03 14:05:36 - mercurios_etl - INFO - ✅ Found aggregation table 'article_sales_agg' with 118 records
2025-03-03 14:05:36 - mercurios_etl - INFO - ✅ Found aggregation table 'article_sales_agg' with 118 records
2025-03-03 14:05:36 - mercurios_etl - INFO - ✅ Found aggregation table 'warehouse_inventory_agg' with 1 records
2025-03-03 14:05:36 - mercurios_etl - INFO - ✅ Found aggregation table 'warehouse_inventory_agg' with 1 records
2025-03-03 14:05:36 - mercurios_etl - INFO - ✅ Sync operation successful
2025-03-03 14:05:36 - mercurios_etl - INFO - ✅ Sync operation successful
2025-03-03 14:05:36 - mercurios_etl - INFO - ===== VERIFYING SHOP MAPPING =====
2025-03-03 14:05:36 - mercurios_etl - INFO - ===== VERIFYING SHOP MAPPING =====
2025-03-03 14:05:36 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:05:36 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:05:36 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:05:36 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:05:36 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:05:36 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:05:37 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:05:37 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:05:38 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:05:38 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:05:39 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:05:39 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:05:39 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:05:39 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:05:39 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:05:39 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:05:39 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 14:05:39 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 14:05:39 - mercurios_etl - INFO - Added 1 warehouse inventory aggregation records
2025-03-03 14:05:39 - mercurios_etl - INFO - Added 1 warehouse inventory aggregation records
2025-03-03 14:05:39 - mercurios_etl - INFO - ✅ Shop mapping verified successfully with 5 records
2025-03-03 14:05:39 - mercurios_etl - INFO - ✅ Shop mapping verified successfully with 5 records
2025-03-03 14:05:39 - mercurios_etl - INFO - Sample shop record: {
  "stateNumber": 0,
  "isActive": true,
  "imageName": "",
  "bankCode": 0,
  "email": "neu00511323278",
  "fax": "",
  "id": "0f319673-6c29-4ed2-b28b-8886dd2a9a31",
  "iban": "",
  "glN1": 4399901477599.0,
  "glN2": 4399901477599.0,
  "branchInfo": "",
  "isWebshop": false,
  "stocktakingDate": "2016-03-31T00:00:00",
  "bankAccount": "509450000",
  "logoFileName": "",
  "searchTerm": "Filiale1",
  "name1": "I. G.von der Linde GmbH & CoKG",
  "name2": "",
  "name3": "",
  "number": 1,
  "city": "Hannover",
  "zipCode": "30167",
  "street": "An der Christuskirche 17",
  "bic": "",
  "telephoneNumber": "0511/36 606 0",
  "countryNumber": "D",
  "regionNumber": 0,
  "lastChange": "2022-03-29T15:33:33.3709455",
  "isDeleted": false,
  "openMonday": null,
  "openTuesday": null,
  "openWednesday": null,
  "openThursday": null,
  "openFriday": null,
  "openSaturday": null,
  "openSunday": null,
  "shop_type": "Retail",
  "is_online": false
}
2025-03-03 14:05:39 - mercurios_etl - INFO - Sample shop record: {
  "stateNumber": 0,
  "isActive": true,
  "imageName": "",
  "bankCode": 0,
  "email": "neu00511323278",
  "fax": "",
  "id": "0f319673-6c29-4ed2-b28b-8886dd2a9a31",
  "iban": "",
  "glN1": 4399901477599.0,
  "glN2": 4399901477599.0,
  "branchInfo": "",
  "isWebshop": false,
  "stocktakingDate": "2016-03-31T00:00:00",
  "bankAccount": "509450000",
  "logoFileName": "",
  "searchTerm": "Filiale1",
  "name1": "I. G.von der Linde GmbH & CoKG",
  "name2": "",
  "name3": "",
  "number": 1,
  "city": "Hannover",
  "zipCode": "30167",
  "street": "An der Christuskirche 17",
  "bic": "",
  "telephoneNumber": "0511/36 606 0",
  "countryNumber": "D",
  "regionNumber": 0,
  "lastChange": "2022-03-29T15:33:33.3709455",
  "isDeleted": false,
  "openMonday": null,
  "openTuesday": null,
  "openWednesday": null,
  "openThursday": null,
  "openFriday": null,
  "openSaturday": null,
  "openSunday": null,
  "shop_type": "Retail",
  "is_online": false
}
2025-03-03 14:05:39 - mercurios_etl - INFO - ===== VERIFYING AGGREGATIONS =====
2025-03-03 14:05:39 - mercurios_etl - INFO - ===== VERIFYING AGGREGATIONS =====
2025-03-03 14:05:39 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:05:39 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-03 14:05:39 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:05:39 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-03 14:05:40 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:05:40 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-03 14:05:40 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:05:40 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-03 14:05:42 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:05:42 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-03 14:05:42 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:05:42 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-03 14:05:42 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:05:42 - mercurios_etl - INFO - Added 4 daily sales aggregation records
2025-03-03 14:05:42 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:05:42 - mercurios_etl - INFO - Added 118 article sales aggregation records
2025-03-03 14:05:42 - data_enhancer - WARNING - No warehouse column found in inventory data
2025-03-03 14:05:42 - data_enhancer - WARNING - No quantity column found in inventory data
2025-03-03 14:05:42 - mercurios_etl - INFO - Added 1 warehouse inventory aggregation records
2025-03-03 14:05:42 - mercurios_etl - INFO - Added 1 warehouse inventory aggregation records
2025-03-03 14:05:42 - mercurios_etl - INFO - ✅ Found 4 daily sales aggregation records
2025-03-03 14:05:42 - mercurios_etl - INFO - ✅ Found 4 daily sales aggregation records
2025-03-03 14:05:42 - mercurios_etl - INFO - ✅ Daily sales aggregation structure verified
2025-03-03 14:05:42 - mercurios_etl - INFO - ✅ Daily sales aggregation structure verified
2025-03-03 14:05:42 - mercurios_etl - INFO - Sample daily sales aggregation: {
  "date": "2015-11-13",
  "total_quantity": 0.0,
  "sale_count": 6,
  "aggregation_type": "daily"
}
2025-03-03 14:05:42 - mercurios_etl - INFO - Sample daily sales aggregation: {
  "date": "2015-11-13",
  "total_quantity": 0.0,
  "sale_count": 6,
  "aggregation_type": "daily"
}
2025-03-03 14:05:42 - mercurios_etl - INFO - ✅ Found 118 article sales aggregation records
2025-03-03 14:05:42 - mercurios_etl - INFO - ✅ Found 118 article sales aggregation records
2025-03-03 14:05:42 - mercurios_etl - INFO - ✅ Found 1 warehouse inventory aggregation records
2025-03-03 14:05:42 - mercurios_etl - INFO - ✅ Found 1 warehouse inventory aggregation records
2025-03-03 14:05:42 - mercurios_etl - INFO - 
===== TEST SUMMARY =====
2025-03-03 14:05:42 - mercurios_etl - INFO - 
===== TEST SUMMARY =====
2025-03-03 14:05:42 - mercurios_etl - INFO - Lambda Handler Test: ✅ PASS
2025-03-03 14:05:42 - mercurios_etl - INFO - Lambda Handler Test: ✅ PASS
2025-03-03 14:05:42 - mercurios_etl - INFO - Shop Mapping Test: ✅ PASS
2025-03-03 14:05:42 - mercurios_etl - INFO - Shop Mapping Test: ✅ PASS
2025-03-03 14:05:42 - mercurios_etl - INFO - Aggregations Test: ✅ PASS
2025-03-03 14:05:42 - mercurios_etl - INFO - Aggregations Test: ✅ PASS
2025-03-03 14:05:42 - mercurios_etl - INFO - 
Overall Test Status: ✅ PASS
2025-03-03 14:05:42 - mercurios_etl - INFO - 
Overall Test Status: ✅ PASS
2025-03-03 14:05:42 - mercurios_etl - INFO - 
🎉 The Lambda function is ready for deployment! 🎉
2025-03-03 14:05:42 - mercurios_etl - INFO - 
🎉 The Lambda function is ready for deployment! 🎉
2025-03-08 12:48:30 - mercurios_etl - INFO - Loading schemas from: /Users/juliusrechenbach/API ProHandelTest/etl/validators/schemas
2025-03-08 12:48:30 - mercurios_etl - INFO - Loading schemas from: /Users/juliusrechenbach/API ProHandelTest/etl/validators/schemas
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for article with 19 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for article with 19 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for customer with 20 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for customer with 20 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for order with 17 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for order with 17 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for sale with 29 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for sale with 29 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for inventory with 11 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for inventory with 11 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for branch with 19 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for branch with 19 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for supplier with 28 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for supplier with 28 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for category with 13 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for category with 13 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for staff with 29 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - Loaded schema for staff with 29 columns
2025-03-08 12:48:30 - mercurios_etl - INFO - No schema file found for shop, fetching sample data
2025-03-08 12:48:30 - mercurios_etl - INFO - No schema file found for shop, fetching sample data
2025-03-08 12:48:30 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 5)
2025-03-08 12:48:30 - mercurios_etl - INFO - Fetching shop data (page 1, pagesize 5)
2025-03-08 12:48:30 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-08 12:48:30 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-08 12:48:30 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-08 12:48:30 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-08 12:48:30 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-08 12:48:30 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-08 12:48:30 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-08 12:48:30 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-08 12:48:30 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-08 12:48:30 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-08 12:48:30 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-08 13:18:30.717352
2025-03-08 12:48:30 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-08 13:18:30.717352
2025-03-08 12:48:33 - mercurios_etl - WARNING - Skipping shop - could not determine schema
2025-03-08 12:48:33 - mercurios_etl - WARNING - Skipping shop - could not determine schema
2025-03-08 12:48:33 - mercurios_etl - INFO - Loaded schema for articlesize with 23 columns
2025-03-08 12:48:33 - mercurios_etl - INFO - Loaded schema for articlesize with 23 columns
2025-03-08 12:48:33 - mercurios_etl - INFO - Loaded schema for country with 11 columns
2025-03-08 12:48:33 - mercurios_etl - INFO - Loaded schema for country with 11 columns
2025-03-08 12:48:33 - mercurios_etl - INFO - Loaded schema for currency with 7 columns
2025-03-08 12:48:33 - mercurios_etl - INFO - Loaded schema for currency with 7 columns
2025-03-08 12:48:33 - mercurios_etl - INFO - Loaded schema for invoice with 17 columns
2025-03-08 12:48:33 - mercurios_etl - INFO - Loaded schema for invoice with 17 columns
2025-03-08 12:48:33 - mercurios_etl - INFO - Loaded schema for payment with 15 columns
2025-03-08 12:48:33 - mercurios_etl - INFO - Loaded schema for payment with 15 columns
2025-03-08 12:48:33 - mercurios_etl - INFO - Loaded schema for season with 8 columns
2025-03-08 12:48:33 - mercurios_etl - INFO - Loaded schema for season with 8 columns
2025-03-08 12:48:33 - mercurios_etl - INFO - Loaded schema for size with 6 columns
2025-03-08 12:48:33 - mercurios_etl - INFO - Loaded schema for size with 6 columns
2025-03-08 12:48:33 - mercurios_etl - INFO - Generated schema with 19 tables
2025-03-08 12:48:33 - mercurios_etl - INFO - Generated schema with 19 tables
2025-03-08 12:48:33 - mercurios_etl - INFO - Table article: 21 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table article: 21 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table customer: 21 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table customer: 21 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table order: 19 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table order: 19 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table sale: 30 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table sale: 30 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table inventory: 12 columns, primary key: ['id', 'branchNumber', 'articleNumber']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table inventory: 12 columns, primary key: ['id', 'branchNumber', 'articleNumber']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table shop: 21 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table shop: 21 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table supplier: 28 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table supplier: 28 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table category: 13 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table category: 13 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table staff: 29 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table staff: 29 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table articlesize: 23 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table articlesize: 23 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table country: 11 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table country: 11 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table currency: 7 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table currency: 7 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table invoice: 17 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table invoice: 17 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table payment: 15 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table payment: 15 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table season: 8 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table season: 8 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table size: 6 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table size: 6 columns, primary key: ['id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table daily_sales_agg: 5 columns, primary key: ['sale_date']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table daily_sales_agg: 5 columns, primary key: ['sale_date']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table article_sales_agg: 10 columns, primary key: ['agg_id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table article_sales_agg: 10 columns, primary key: ['agg_id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table warehouse_inventory_agg: 5 columns, primary key: ['agg_id']
2025-03-08 12:48:33 - mercurios_etl - INFO - Table warehouse_inventory_agg: 5 columns, primary key: ['agg_id']
2025-03-08 12:48:41 - mercurios_etl - INFO - Ensuring connector is authenticated before sync
2025-03-08 12:48:41 - mercurios_etl - INFO - Ensuring connector is authenticated before sync
2025-03-08 12:48:41 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-08 12:48:41 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-08 12:48:41 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-08 12:48:41 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-08 12:48:41 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-08 12:48:41 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-08 12:48:41 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-08 12:48:41 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-08 12:48:41 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-08 12:48:41 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-08 12:48:41 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-08 13:18:41.322056
2025-03-08 12:48:41 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-08 13:18:41.322056
2025-03-08 12:48:41 - mercurios_etl - INFO - Fetching all article data (first sync)
2025-03-08 12:48:41 - mercurios_etl - INFO - Fetching all article data (first sync)
2025-03-08 12:48:41 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-08 12:48:41 - mercurios_etl - INFO - Fetching article data (page 1, pagesize 100)
2025-03-08 12:48:41 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-08 12:48:41 - mercurios_etl - INFO - Authenticating with ProHandel API at https://auth.prohandel.cloud/api/v4...
2025-03-08 12:48:41 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-08 12:48:41 - mercurios_etl - INFO - Using token URL: https://auth.prohandel.cloud/api/v4/token
2025-03-08 12:48:41 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-08 12:48:41 - mercurios_etl - INFO - Authentication response received: dict_keys(['token', 'serverUrl', 'requiredActions'])
2025-03-08 12:48:41 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-08 12:48:41 - mercurios_etl - INFO - Server URL from response: https://linde.prohandel.de
2025-03-08 12:48:41 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-08 12:48:41 - mercurios_etl - INFO - Updated API URL to: https://linde.prohandel.de
2025-03-08 12:48:41 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-08 13:18:41.476272
2025-03-08 12:48:41 - mercurios_etl - INFO - Authentication successful. Token expires at 2025-03-08 13:18:41.476272
2025-03-08 12:48:41 - mercurios_etl - INFO - Retrieved 100 article records
2025-03-08 12:48:41 - mercurios_etl - INFO - Retrieved 100 article records
2025-03-08 12:48:41 - mercurios_etl - INFO - Enhanced 100 article records
2025-03-08 12:48:41 - mercurios_etl - INFO - Enhanced 100 article records
2025-03-08 12:48:41 - mercurios_etl - INFO - Added 100 article records to insert response
2025-03-08 12:48:41 - mercurios_etl - INFO - Added 100 article records to insert response
2025-03-08 12:48:41 - mercurios_etl - ERROR - Error processing entity article: name 'timezone' is not defined
2025-03-08 12:48:41 - mercurios_etl - ERROR - Error processing entity article: name 'timezone' is not defined
2025-03-08 12:48:41 - mercurios_etl - INFO - Fetching all customer data (first sync)
2025-03-08 12:48:41 - mercurios_etl - INFO - Fetching all customer data (first sync)
2025-03-08 12:48:41 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-08 12:48:41 - mercurios_etl - INFO - Fetching customer data (page 1, pagesize 100)
2025-03-08 12:48:43 - mercurios_etl - INFO - Retrieved 100 customer records
2025-03-08 12:48:43 - mercurios_etl - INFO - Retrieved 100 customer records
2025-03-08 12:48:43 - mercurios_etl - INFO - Enhanced 100 customer records
2025-03-08 12:48:43 - mercurios_etl - INFO - Enhanced 100 customer records
2025-03-08 12:48:43 - mercurios_etl - INFO - Added 100 customer records to insert response
2025-03-08 12:48:43 - mercurios_etl - INFO - Added 100 customer records to insert response
2025-03-08 12:48:43 - mercurios_etl - ERROR - Error processing entity customer: name 'timezone' is not defined
2025-03-08 12:48:43 - mercurios_etl - ERROR - Error processing entity customer: name 'timezone' is not defined
2025-03-08 12:48:43 - mercurios_etl - INFO - Fetching all order data (first sync)
2025-03-08 12:48:43 - mercurios_etl - INFO - Fetching all order data (first sync)
2025-03-08 12:48:43 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-08 12:48:43 - mercurios_etl - INFO - Fetching order data (page 1, pagesize 50)
2025-03-08 12:48:47 - mercurios_etl - INFO - Retrieved 50 order records
2025-03-08 12:48:47 - mercurios_etl - INFO - Retrieved 50 order records
2025-03-08 12:48:47 - mercurios_etl - INFO - Enhanced 50 order records
2025-03-08 12:48:47 - mercurios_etl - INFO - Enhanced 50 order records
2025-03-08 12:48:47 - mercurios_etl - INFO - Added 50 order records to insert response
2025-03-08 12:48:47 - mercurios_etl - INFO - Added 50 order records to insert response
2025-03-08 12:48:47 - mercurios_etl - ERROR - Error processing entity order: name 'timezone' is not defined
2025-03-08 12:48:47 - mercurios_etl - ERROR - Error processing entity order: name 'timezone' is not defined
2025-03-08 12:48:47 - mercurios_etl - INFO - Fetching all sale data (first sync)
2025-03-08 12:48:47 - mercurios_etl - INFO - Fetching all sale data (first sync)
2025-03-08 12:48:47 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-08 12:48:47 - mercurios_etl - INFO - Fetching sale data (page 1, pagesize 200)
2025-03-08 12:48:49 - mercurios_etl - INFO - Retrieved 200 sale records
2025-03-08 12:48:49 - mercurios_etl - INFO - Retrieved 200 sale records
2025-03-08 12:48:49 - mercurios_etl - INFO - Enhanced 200 sale records
2025-03-08 12:48:49 - mercurios_etl - INFO - Enhanced 200 sale records
2025-03-08 12:48:49 - mercurios_etl - INFO - Added 200 sale records to insert response
2025-03-08 12:48:49 - mercurios_etl - INFO - Added 200 sale records to insert response
2025-03-08 12:48:49 - mercurios_etl - ERROR - Error processing entity sale: name 'timezone' is not defined
2025-03-08 12:48:49 - mercurios_etl - ERROR - Error processing entity sale: name 'timezone' is not defined
2025-03-08 12:48:49 - mercurios_etl - INFO - Fetching all inventory data (first sync)
2025-03-08 12:48:49 - mercurios_etl - INFO - Fetching all inventory data (first sync)
2025-03-08 12:48:49 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-08 12:48:49 - mercurios_etl - INFO - Fetching inventory data (page 1, pagesize 200)
2025-03-08 12:48:49 - mercurios_etl - INFO - Retrieved 200 inventory records
2025-03-08 12:48:49 - mercurios_etl - INFO - Retrieved 200 inventory records
2025-03-08 12:48:49 - mercurios_etl - INFO - Enhanced 200 inventory records
2025-03-08 12:48:49 - mercurios_etl - INFO - Enhanced 200 inventory records
2025-03-08 12:48:49 - mercurios_etl - INFO - Added 200 inventory records to insert response
2025-03-08 12:48:49 - mercurios_etl - INFO - Added 200 inventory records to insert response
2025-03-08 12:48:49 - mercurios_etl - ERROR - Error processing entity inventory: name 'timezone' is not defined
2025-03-08 12:48:49 - mercurios_etl - ERROR - Error processing entity inventory: name 'timezone' is not defined
2025-03-08 12:48:49 - mercurios_etl - INFO - Fetching all branch data (first sync)
2025-03-08 12:48:49 - mercurios_etl - INFO - Fetching all branch data (first sync)
2025-03-08 12:48:49 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-08 12:48:49 - mercurios_etl - INFO - Fetching branch data (page 1, pagesize 50)
2025-03-08 12:48:49 - mercurios_etl - INFO - Retrieved 5 branch records
2025-03-08 12:48:49 - mercurios_etl - INFO - Retrieved 5 branch records
2025-03-08 12:48:49 - mercurios_etl - INFO - Enhanced 5 branch records
2025-03-08 12:48:49 - mercurios_etl - INFO - Enhanced 5 branch records
2025-03-08 12:48:49 - mercurios_etl - INFO - Added 5 shop records to insert response
2025-03-08 12:48:49 - mercurios_etl - INFO - Added 5 shop records to insert response
2025-03-08 12:48:49 - mercurios_etl - ERROR - Error processing entity branch: name 'timezone' is not defined
2025-03-08 12:48:49 - mercurios_etl - ERROR - Error processing entity branch: name 'timezone' is not defined
2025-03-08 12:48:49 - mercurios_etl - INFO - Generating daily sales aggregations from 200 sales records
2025-03-08 12:48:49 - mercurios_etl - INFO - Generating daily sales aggregations from 200 sales records
2025-03-08 12:48:49 - mercurios_etl - ERROR - Error during daily sales aggregation: 'DataEnhancer' object has no attribute 'aggregate_daily_sales'
Traceback (most recent call last):
  File "/Users/juliusrechenbach/API ProHandelTest/lambda_connector/lambda_function.py", line 486, in handle_sync
    daily_sales = enhancer.aggregate_daily_sales(sales_copy)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataEnhancer' object has no attribute 'aggregate_daily_sales'
2025-03-08 12:48:49 - mercurios_etl - ERROR - Error during daily sales aggregation: 'DataEnhancer' object has no attribute 'aggregate_daily_sales'
Traceback (most recent call last):
  File "/Users/juliusrechenbach/API ProHandelTest/lambda_connector/lambda_function.py", line 486, in handle_sync
    daily_sales = enhancer.aggregate_daily_sales(sales_copy)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataEnhancer' object has no attribute 'aggregate_daily_sales'
2025-03-08 12:48:49 - mercurios_etl - INFO - Generating article sales aggregations from 200 sales and 100 article records
2025-03-08 12:48:49 - mercurios_etl - INFO - Generating article sales aggregations from 200 sales and 100 article records
2025-03-08 12:48:49 - mercurios_etl - ERROR - Error during article sales aggregation: 'DataEnhancer' object has no attribute 'aggregate_article_sales'
Traceback (most recent call last):
  File "/Users/juliusrechenbach/API ProHandelTest/lambda_connector/lambda_function.py", line 502, in handle_sync
    article_sales = enhancer.aggregate_article_sales(sales_copy, articles_copy)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataEnhancer' object has no attribute 'aggregate_article_sales'
2025-03-08 12:48:49 - mercurios_etl - ERROR - Error during article sales aggregation: 'DataEnhancer' object has no attribute 'aggregate_article_sales'
Traceback (most recent call last):
  File "/Users/juliusrechenbach/API ProHandelTest/lambda_connector/lambda_function.py", line 502, in handle_sync
    article_sales = enhancer.aggregate_article_sales(sales_copy, articles_copy)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataEnhancer' object has no attribute 'aggregate_article_sales'
2025-03-08 12:48:49 - mercurios_etl - INFO - Generating warehouse inventory aggregations from 200 inventory records
2025-03-08 12:48:49 - mercurios_etl - INFO - Generating warehouse inventory aggregations from 200 inventory records
2025-03-08 12:48:49 - mercurios_etl - ERROR - Error during warehouse inventory aggregation: 'DataEnhancer' object has no attribute 'aggregate_warehouse_inventory'
Traceback (most recent call last):
  File "/Users/juliusrechenbach/API ProHandelTest/lambda_connector/lambda_function.py", line 522, in handle_sync
    warehouse_inventory = enhancer.aggregate_warehouse_inventory(inventory_copy)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataEnhancer' object has no attribute 'aggregate_warehouse_inventory'
2025-03-08 12:48:49 - mercurios_etl - ERROR - Error during warehouse inventory aggregation: 'DataEnhancer' object has no attribute 'aggregate_warehouse_inventory'
Traceback (most recent call last):
  File "/Users/juliusrechenbach/API ProHandelTest/lambda_connector/lambda_function.py", line 522, in handle_sync
    warehouse_inventory = enhancer.aggregate_warehouse_inventory(inventory_copy)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataEnhancer' object has no attribute 'aggregate_warehouse_inventory'
2025-03-08 12:48:49 - mercurios_etl - INFO - Sync summary:
2025-03-08 12:48:49 - mercurios_etl - INFO - Sync summary:
2025-03-08 12:48:49 - mercurios_etl - INFO -   article: 100 records
2025-03-08 12:48:49 - mercurios_etl - INFO -   article: 100 records
2025-03-08 12:48:49 - mercurios_etl - INFO -   customer: 100 records
2025-03-08 12:48:49 - mercurios_etl - INFO -   customer: 100 records
2025-03-08 12:48:49 - mercurios_etl - INFO -   order: 50 records
2025-03-08 12:48:49 - mercurios_etl - INFO -   order: 50 records
2025-03-08 12:48:49 - mercurios_etl - INFO -   sale: 200 records
2025-03-08 12:48:49 - mercurios_etl - INFO -   sale: 200 records
2025-03-08 12:48:49 - mercurios_etl - INFO -   inventory: 200 records
2025-03-08 12:48:49 - mercurios_etl - INFO -   inventory: 200 records
2025-03-08 12:48:49 - mercurios_etl - INFO -   shop: 5 records
2025-03-08 12:48:49 - mercurios_etl - INFO -   shop: 5 records
